var mo=Object.defineProperty;var _o=(t,e,n)=>e in t?mo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Ct=(t,e,n)=>(_o(t,typeof e!="symbol"?e+"":e,n),n);import{M as st,S as dt,i as gt,s as pt,N as Pt,O as Q,P as Z,m as V,h as M,n as p,Q as Wt,b as U,K as G,R as We,C as ct,T as Kt,e as Tt,q as jt,r as Ut,u as Ke,a as xt,c as St,U as et,f as q,g as Lt,t as K,d as Rt,E as se,L as it,x as ut,y as mt,z as ft,A as ht,V as ln,W as Nt,w as Rn,k as at,l as lt,p as J,X as Ht,Y as vt,Z as nn,_ as Pr,v as de,$ as zn,o as Ar,B as vo,a0 as yo,j as wo,a1 as Bn,a2 as bo,a3 as Xn}from"../../chunks/index-dd609de2.js";import{d as ko,w as _t}from"../../chunks/index-883bfc0f.js";var Xe={},Eo={get exports(){return Xe},set exports(t){Xe=t}},ee=typeof Reflect=="object"?Reflect:null,Dn=ee&&typeof ee.apply=="function"?ee.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},Oe;ee&&typeof ee.ownKeys=="function"?Oe=ee.ownKeys:Object.getOwnPropertySymbols?Oe=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Oe=function(e){return Object.getOwnPropertyNames(e)};function xo(t){console&&console.warn&&console.warn(t)}var Cr=Number.isNaN||function(e){return e!==e};function $(){$.init.call(this)}Eo.exports=$;Xe.once=To;$.EventEmitter=$;$.prototype._events=void 0;$.prototype._eventsCount=0;$.prototype._maxListeners=void 0;var Yn=10;function Qe(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty($,"defaultMaxListeners",{enumerable:!0,get:function(){return Yn},set:function(t){if(typeof t!="number"||t<0||Cr(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Yn=t}});$.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};$.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||Cr(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Mr(t){return t._maxListeners===void 0?$.defaultMaxListeners:t._maxListeners}$.prototype.getMaxListeners=function(){return Mr(this)};$.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var o=e==="error",i=this._events;if(i!==void 0)o=o&&i.error===void 0;else if(!o)return!1;if(o){var s;if(n.length>0&&(s=n[0]),s instanceof Error)throw s;var l=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw l.context=s,l}var a=i[e];if(a===void 0)return!1;if(typeof a=="function")Dn(a,this,n);else for(var c=a.length,u=Br(a,c),r=0;r<c;++r)Dn(u[r],this,n);return!0};function Or(t,e,n,r){var o,i,s;if(Qe(n),i=t._events,i===void 0?(i=t._events=Object.create(null),t._eventsCount=0):(i.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),s===void 0)s=i[e]=n,++t._eventsCount;else if(typeof s=="function"?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),o=Mr(t),o>0&&s.length>o&&!s.warned){s.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=s.length,xo(l)}return t}$.prototype.addListener=function(e,n){return Or(this,e,n,!1)};$.prototype.on=$.prototype.addListener;$.prototype.prependListener=function(e,n){return Or(this,e,n,!0)};function So(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Lr(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=So.bind(r);return o.listener=n,r.wrapFn=o,o}$.prototype.once=function(e,n){return Qe(n),this.on(e,Lr(this,e,n)),this};$.prototype.prependOnceListener=function(e,n){return Qe(n),this.prependListener(e,Lr(this,e,n)),this};$.prototype.removeListener=function(e,n){var r,o,i,s,l;if(Qe(n),o=this._events,o===void 0)return this;if(r=o[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete o[e],o.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(i=-1,s=r.length-1;s>=0;s--)if(r[s]===n||r[s].listener===n){l=r[s].listener,i=s;break}if(i<0)return this;i===0?r.shift():Io(r,i),r.length===1&&(o[e]=r[0]),o.removeListener!==void 0&&this.emit("removeListener",e,l||n)}return this};$.prototype.off=$.prototype.removeListener;$.prototype.removeAllListeners=function(e){var n,r,o;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var i=Object.keys(r),s;for(o=0;o<i.length;++o)s=i[o],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(o=n.length-1;o>=0;o--)this.removeListener(e,n[o]);return this};function Rr(t,e,n){var r=t._events;if(r===void 0)return[];var o=r[e];return o===void 0?[]:typeof o=="function"?n?[o.listener||o]:[o]:n?No(o):Br(o,o.length)}$.prototype.listeners=function(e){return Rr(this,e,!0)};$.prototype.rawListeners=function(e){return Rr(this,e,!1)};$.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):zr.call(t,e)};$.prototype.listenerCount=zr;function zr(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}$.prototype.eventNames=function(){return this._eventsCount>0?Oe(this._events):[]};function Br(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function Io(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function No(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function To(t,e){return new Promise(function(n,r){function o(s){t.removeListener(e,i),r(s)}function i(){typeof t.removeListener=="function"&&t.removeListener("error",o),n([].slice.call(arguments))}Xr(t,e,i,{once:!0}),e!=="error"&&Po(t,o,{once:!0})})}function Po(t,e,n){typeof t.on=="function"&&Xr(t,"error",e,n)}function Xr(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function o(i){r.once&&t.removeEventListener(e,o),n(i)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}const Qt=function(){function t(u,f){return f!=null&&u instanceof f}var e;try{e=Map}catch{e=function(){}}var n;try{n=Set}catch{n=function(){}}var r;try{r=Promise}catch{r=function(){}}function o(u,f,g,m,_){typeof f=="object"&&(g=f.depth,m=f.prototype,_=f.includeNonEnumerable,f=f.circular);var x=[],w=[],b=typeof Buffer<"u";typeof f>"u"&&(f=!0),typeof g>"u"&&(g=1/0);function S(A,N){if(A===null)return null;if(N===0)return A;var d,h;if(typeof A!="object")return A;if(t(A,e))d=new e;else if(t(A,n))d=new n;else if(t(A,r))d=new r(function(C,T){A.then(function(L){C(S(L,N-1))},function(L){T(S(L,N-1))})});else if(o.__isArray(A))d=[];else if(o.__isRegExp(A))d=new RegExp(A.source,c(A)),A.lastIndex&&(d.lastIndex=A.lastIndex);else if(o.__isDate(A))d=new Date(A.getTime());else{if(b&&Buffer.isBuffer(A))return Buffer.allocUnsafe?d=Buffer.allocUnsafe(A.length):d=new Buffer(A.length),A.copy(d),d;t(A,Error)?d=Object.create(A):typeof m>"u"?(h=Object.getPrototypeOf(A),d=Object.create(h)):(d=Object.create(m),h=m)}if(f){var E=x.indexOf(A);if(E!=-1)return w[E];x.push(A),w.push(d)}t(A,e)&&A.forEach(function(C,T){var L=S(T,N-1),O=S(C,N-1);d.set(L,O)}),t(A,n)&&A.forEach(function(C){var T=S(C,N-1);d.add(T)});for(var I in A){var k;h&&(k=Object.getOwnPropertyDescriptor(h,I)),!(k&&k.set==null)&&(d[I]=S(A[I],N-1))}if(Object.getOwnPropertySymbols)for(var z=Object.getOwnPropertySymbols(A),I=0;I<z.length;I++){var j=z[I],Y=Object.getOwnPropertyDescriptor(A,j);Y&&!Y.enumerable&&!_||(d[j]=S(A[j],N-1),Y.enumerable||Object.defineProperty(d,j,{enumerable:!1}))}if(_)for(var nt=Object.getOwnPropertyNames(A),I=0;I<nt.length;I++){var y=nt[I],Y=Object.getOwnPropertyDescriptor(A,y);Y&&Y.enumerable||(d[y]=S(A[y],N-1),Object.defineProperty(d,y,{enumerable:!1}))}return d}return S(u,g)}o.clonePrototype=function(f){if(f===null)return null;var g=function(){};return g.prototype=f,new g};function i(u){return Object.prototype.toString.call(u)}o.__objToStr=i;function s(u){return typeof u=="object"&&i(u)==="[object Date]"}o.__isDate=s;function l(u){return typeof u=="object"&&i(u)==="[object Array]"}o.__isArray=l;function a(u){return typeof u=="object"&&i(u)==="[object RegExp]"}o.__isRegExp=a;function c(u){var f="";return u.global&&(f+="g"),u.ignoreCase&&(f+="i"),u.multiline&&(f+="m"),f}return o.__getRegExpFlags=c,o}();class kn extends Xe.EventEmitter{constructor(n="",r={}){super();Ct(this,"name");Ct(this,"properties");Ct(this,"nodes");Ct(this,"edges");Ct(this,"initializers");Ct(this,"inports");Ct(this,"outports");Ct(this,"groups");Ct(this,"transaction");Ct(this,"caseSensitive");this.setMaxListeners(0),this.name=n,this.properties={},this.nodes=[],this.edges=[],this.initializers=[],this.inports={},this.outports={},this.groups=[],this.transaction={id:null,depth:0},this.caseSensitive=r.caseSensitive||!1}getPortName(n=""){return this.caseSensitive?n:n.toLowerCase()}startTransaction(n,r={}){if(this.transaction.id)throw Error("Nested transactions not supported");return this.transaction.id=n,this.transaction.depth=1,this.emit("startTransaction",n,r),this}endTransaction(n,r={}){if(!this.transaction.id)throw Error("Attempted to end non-existing transaction");return this.transaction.id=null,this.transaction.depth=0,this.emit("endTransaction",n,r),this}checkTransactionStart(){return this.transaction.id?this.transaction.id==="implicit"&&(this.transaction.depth+=1):this.startTransaction("implicit"),this}checkTransactionEnd(){return this.transaction.id==="implicit"&&(this.transaction.depth-=1),this.transaction.depth===0&&this.endTransaction("implicit"),this}setProperties(n){this.checkTransactionStart();const r=Qt(this.properties);return Object.keys(n).forEach(o=>{const i=n[o];this.properties[o]=i}),this.emit("changeProperties",this.properties,r),this.checkTransactionEnd(),this}addInport(n,r,o,i={}){if(!this.getNode(r))return this;const s=this.getPortName(n);return this.checkTransactionStart(),this.inports[s]={process:r,port:this.getPortName(o),metadata:i},this.emit("addInport",s,this.inports[s]),this.checkTransactionEnd(),this}removeInport(n){const r=this.getPortName(n);if(!this.inports[r])return this;this.checkTransactionStart();const o=this.inports[r];return this.setInportMetadata(r,{}),delete this.inports[r],this.emit("removeInport",r,o),this.checkTransactionEnd(),this}renameInport(n,r){const o=this.getPortName(n),i=this.getPortName(r);return this.inports[o]?i===o?this:(this.checkTransactionStart(),this.inports[i]=this.inports[o],delete this.inports[o],this.emit("renameInport",o,i),this.checkTransactionEnd(),this):this}setInportMetadata(n,r){const o=this.getPortName(n);if(!this.inports[o])return this;this.checkTransactionStart(),this.inports[o].metadata||(this.inports[o].metadata={});const i=Qt(this.inports[o].metadata);return Object.keys(r).forEach(s=>{const l=r[s],a=this.inports[o].metadata;a&&(l!=null?a[s]=l:delete a[s])}),this.emit("changeInport",o,this.inports[o],i,r),this.checkTransactionEnd(),this}addOutport(n,r,o,i={}){if(!this.getNode(r))return this;const s=this.getPortName(n);return this.checkTransactionStart(),this.outports[s]={process:r,port:this.getPortName(o),metadata:i},this.emit("addOutport",s,this.outports[s]),this.checkTransactionEnd(),this}removeOutport(n){const r=this.getPortName(n);if(!this.outports[r])return this;this.checkTransactionStart();const o=this.outports[r];return this.setOutportMetadata(r,{}),delete this.outports[r],this.emit("removeOutport",r,o),this.checkTransactionEnd(),this}renameOutport(n,r){const o=this.getPortName(n),i=this.getPortName(r);return this.outports[o]?(this.checkTransactionStart(),this.outports[i]=this.outports[o],delete this.outports[o],this.emit("renameOutport",o,i),this.checkTransactionEnd(),this):this}setOutportMetadata(n,r){const o=this.getPortName(n);if(!this.outports[o])return this;this.checkTransactionStart();const i=Qt(this.outports[o].metadata);return this.outports[o].metadata||(this.outports[o].metadata={}),Object.keys(r).forEach(s=>{const l=r[s],a=this.outports[o].metadata;a&&(l!=null?a[s]=l:delete a[s])}),this.emit("changeOutport",o,this.outports[o],i,r),this.checkTransactionEnd(),this}addGroup(n,r,o){this.checkTransactionStart();const i={name:n,nodes:r,metadata:o};return this.groups.push(i),this.emit("addGroup",i),this.checkTransactionEnd(),this}renameGroup(n,r){return this.checkTransactionStart(),this.groups.forEach(o=>{if(!o||o.name!==n)return;const i=o;i.name=r,this.emit("renameGroup",n,r)}),this.checkTransactionEnd(),this}removeGroup(n){return this.checkTransactionStart(),this.groups=this.groups.filter(r=>r?r.name!==n?!0:(this.setGroupMetadata(r.name,{}),this.emit("removeGroup",r),!1):!1),this.checkTransactionEnd(),this}setGroupMetadata(n,r){return this.checkTransactionStart(),this.groups.forEach(o=>{if(!o||o.name!==n)return;const i=Qt(o.metadata);Object.keys(r).forEach(s=>{const l=r[s],a=o;a.metadata&&(l!=null?a.metadata[s]=l:delete a.metadata[s])}),this.emit("changeGroup",o,i,r)}),this.checkTransactionEnd(),this}addNode(n,r,o={}){this.checkTransactionStart();const i={id:n,component:r,metadata:o};return this.nodes.push(i),this.emit("addNode",i),this.checkTransactionEnd(),this}removeNode(n){const r=this.getNode(n);return r?(this.checkTransactionStart(),this.edges.forEach(o=>{(o.from.node===r.id||o.to.node===r.id)&&this.removeEdge(o.from.node,o.from.port,o.to.node,o.to.port)}),this.initializers.forEach(o=>{o.to.node===r.id&&this.removeInitial(o.to.node,o.to.port)}),Object.keys(this.inports).forEach(o=>{this.inports[o].process===n&&this.removeInport(o)}),Object.keys(this.outports).forEach(o=>{this.outports[o].process===n&&this.removeOutport(o)}),this.groups.forEach(o=>{if(!o)return;const i=o.nodes.indexOf(n);i!==-1&&(o.nodes.splice(i,1),o.nodes.length===0&&this.removeGroup(o.name))}),this.setNodeMetadata(n,{}),this.nodes=this.nodes.filter(o=>o!==r),this.emit("removeNode",r),this.checkTransactionEnd(),this):this}getNode(n){const r=this.nodes.find(o=>o&&o.id===n);return r||null}renameNode(n,r){this.checkTransactionStart();const o=this.getNode(n);return o?(o.id=r,this.edges.forEach(i=>{const s=i;s&&(s.from.node===n&&(s.from.node=r),s.to.node===n&&(s.to.node=r))}),this.initializers.forEach(i=>{const s=i;s&&s.to.node===n&&(s.to.node=r)}),Object.keys(this.inports).forEach(i=>{const s=this.inports[i];s.process===n&&(s.process=r)}),Object.keys(this.outports).forEach(i=>{const s=this.outports[i];s.process===n&&(s.process=r)}),this.groups.forEach(i=>{if(!i)return;const s=i.nodes.indexOf(n);if(s===-1)return;const l=i;l.nodes[s]=r}),this.emit("renameNode",n,r),this.checkTransactionEnd(),this):this}setNodeMetadata(n,r){const o=this.getNode(n);if(!o)return this;this.checkTransactionStart(),o.metadata||(o.metadata={});const i=Qt(o.metadata);return Object.keys(r).forEach(s=>{if(!o.metadata)return;const l=r[s];l!=null?o.metadata[s]=l:delete o.metadata[s]}),this.emit("changeNode",o,i,r),this.checkTransactionEnd(),this}addEdge(n,r,o,i,s={}){const l=this.getPortName(r),a=this.getPortName(i);if(this.edges.some(u=>u.from.node===n&&u.from.port===l&&u.to.node===o&&u.to.port===a))return this;if(!this.getNode(n))return this;if(!this.getNode(o))return this;this.checkTransactionStart();const c={from:{node:n,port:l},to:{node:o,port:a},metadata:s};return this.edges.push(c),this.emit("addEdge",c),this.checkTransactionEnd(),this}addEdgeIndex(n,r,o,i,s,l,a={}){const c=this.getPortName(r),u=this.getPortName(s),f=l===null?void 0:l,g=o===null?void 0:o;if(this.edges.some(_=>_.from.node===n&&_.from.port===c&&_.from.index===g&&_.to.node===i&&_.to.port===u&&_.to.index===f))return this;if(!this.getNode(n))return this;if(!this.getNode(i))return this;this.checkTransactionStart();const m={from:{node:n,port:c,index:g},to:{node:i,port:u,index:f},metadata:a};return this.edges.push(m),this.emit("addEdge",m),this.checkTransactionEnd(),this}removeEdge(n,r,o,i){if(!this.getEdge(n,r,o,i))return this;this.checkTransactionStart();const s=this.getPortName(r),l=this.getPortName(i);return this.edges=this.edges.filter(a=>{if(o&&l){if(a.from.node===n&&a.from.port===s&&a.to.node===o&&a.to.port===l)return this.setEdgeMetadata(a.from.node,a.from.port,a.to.node,a.to.port,{}),this.emit("removeEdge",a),!1}else if(a.from.node===n&&a.from.port===s||a.to.node===n&&a.to.port===s)return this.setEdgeMetadata(a.from.node,a.from.port,a.to.node,a.to.port,{}),this.emit("removeEdge",a),!1;return!0}),this.checkTransactionEnd(),this}getEdge(n,r,o,i){const s=this.getPortName(r),l=this.getPortName(i),a=this.edges.find(c=>c?c.from.node===n&&c.from.port===s&&c.to.node===o&&c.to.port===l:!1);return a||null}setEdgeMetadata(n,r,o,i,s){const l=this.getEdge(n,r,o,i);if(!l)return this;this.checkTransactionStart(),l.metadata||(l.metadata={});const a=Qt(l.metadata);return Object.keys(s).forEach(c=>{const u=s[c];l.metadata||(l.metadata={}),u!==null?l.metadata[c]=u:delete l.metadata[c]}),this.emit("changeEdge",l,a,s),this.checkTransactionEnd(),this}addInitial(n,r,o,i={}){if(!this.getNode(r))return this;const s=this.getPortName(o);this.checkTransactionStart();const l={from:{data:n},to:{node:r,port:s},metadata:i};return this.initializers.push(l),this.emit("addInitial",l),this.checkTransactionEnd(),this}addInitialIndex(n,r,o,i,s={}){if(!this.getNode(r))return this;const l=i===null?void 0:i,a=this.getPortName(o);this.checkTransactionStart();const c={from:{data:n},to:{node:r,port:a,index:l},metadata:s};return this.initializers.push(c),this.emit("addInitial",c),this.checkTransactionEnd(),this}addGraphInitial(n,r,o={}){const i=this.inports[r];return i?this.addInitial(n,i.process,i.port,o):this}addGraphInitialIndex(n,r,o,i={}){const s=this.inports[r];return s?this.addInitialIndex(n,s.process,s.port,o,i):this}removeInitial(n,r){const o=this.getPortName(r);return this.checkTransactionStart(),this.initializers=this.initializers.filter(i=>i.to.node===n&&i.to.port===o?(this.emit("removeInitial",i),!1):!0),this.checkTransactionEnd(),this}removeGraphInitial(n){const r=this.inports[n];return r?(this.removeInitial(r.process,r.port),this):this}toDOT(){const n=s=>s.replace(/"/g,'\\"'),r=s=>s.replace(/\./g,""),o=s=>`"${n(s)}"`;let i=`digraph {
`;return this.nodes.forEach(s=>{i+=`    ${o(s.id)} [label=${o(s.id)} shape=box]
`}),this.initializers.forEach((s,l)=>{let a;typeof s.from.data=="function"?a="Function":a=JSON.stringify(s.from.data),i+=`    data${l} [label=${o(a)} shape=plaintext]
`,i+=`    data${l} -> ${o(s.to.node)}[headlabel=${r(s.to.port)} labelfontcolor=blue labelfontsize=8.0]
`}),this.edges.forEach(s=>{i+=`    ${o(s.from.node)} -> ${o(s.to.node)}[taillabel=${r(s.from.port)} headlabel=${r(s.to.port)} labelfontcolor=blue labelfontsize=8.0]
`}),i+="}",i}toYUML(){const n=[];return this.initializers.forEach(r=>{n.push(`(start)[${r.to.port}]->(${r.to.node})`)}),this.edges.forEach(r=>{n.push(`(${r.from.node})[${r.from.port}]->(${r.to.node})`)}),n.join(",")}toJSON(){const n={caseSensitive:this.caseSensitive,properties:{name:this.name,...this.properties},inports:{...this.inports},outports:{...this.outports},groups:this.groups.map(r=>{const o={name:r.name,nodes:r.nodes};return r.metadata&&Object.keys(r.metadata).length&&(o.metadata={...r.metadata}),o}),processes:{},connections:[]};return n&&n.properties&&(delete n.properties.baseDir,delete n.properties.componentLoader),this.nodes.forEach(r=>{n.processes||(n.processes={}),n.processes[r.id]={component:r.component},r.metadata&&(n.processes[r.id].metadata={...r.metadata})}),this.edges.forEach(r=>{const o={src:{process:r.from.node,port:r.from.port,index:r.from.index},tgt:{process:r.to.node,port:r.to.port,index:r.to.index}};r.metadata&&Object.keys(r.metadata).length&&(o.metadata={...r.metadata}),n.connections||(n.connections=[]),n.connections.push(o)}),this.initializers.forEach(r=>{const o={data:r.from.data,tgt:{process:r.to.node,port:r.to.port,index:r.to.index}};r.metadata&&Object.keys(r.metadata).length&&(o.metadata={...r.metadata}),n.connections||(n.connections=[]),n.connections.push(o)}),n}}function Ao(t,e){return new kn(t,e)}function Co(t,e,n={}){const r=new Promise(o=>{let i;typeof t=="string"?i=JSON.parse(t):i=Qt(t),i.properties||(i.properties={}),i.processes||(i.processes={}),i.connections||(i.connections=[]);const s=new kn(i.properties.name,{caseSensitive:i.caseSensitive||!1});s.startTransaction("loadJSON",n);const l={};Object.keys(i.properties).forEach(a=>{if(a==="name"||!i.properties)return;const c=i.properties[a];l[a]=c}),s.setProperties(l),Object.keys(i.processes).forEach(a=>{if(!i.processes)return;const c=i.processes[a];c.metadata||(c.metadata={}),s.addNode(a,c.component,c.metadata)}),i.connections.forEach(a=>{const c=a.metadata?a.metadata:{};if(typeof a.data<"u"){typeof a.tgt.index=="number"?s.addInitialIndex(a.data,a.tgt.process,s.getPortName(a.tgt.port),a.tgt.index,c):s.addInitial(a.data,a.tgt.process,s.getPortName(a.tgt.port),c);return}if(!(typeof a.src>"u")){if(typeof a.src.index=="number"||typeof a.tgt.index=="number"){s.addEdgeIndex(a.src.process,s.getPortName(a.src.port),a.src.index,a.tgt.process,s.getPortName(a.tgt.port),a.tgt.index,c);return}s.addEdge(a.src.process,s.getPortName(a.src.port),a.tgt.process,s.getPortName(a.tgt.port),c)}}),i.inports&&Object.keys(i.inports).forEach(a=>{if(!i.inports||!i.inports[a])return;const c=i.inports[a];s.addInport(a,c.process,s.getPortName(c.port),c.metadata||{})}),i.outports&&Object.keys(i.outports).forEach(a=>{if(!i.outports||!i.outports[a])return;const c=i.outports[a];s.addOutport(a,c.process,s.getPortName(c.port),c.metadata||{})}),i.groups&&i.groups.forEach(a=>{s.addGroup(a.name,a.nodes,a.metadata||{})}),s.endTransaction("loadJSON"),o(s)});return e&&r.then(o=>{e(null,o)},e),r}const Mo={Graph:kn,createGraph:Ao,loadJSON:Co},It={};function Oo(t,e,n,r){var o,i,s=!1,l=n.length>=2,a=(_,x)=>{if(o=x,l&&(i=_),!s){let w=e(_,x);if(e.length<2)x(w);else return w}s=!1},c=ko(t,a,r),u=!Array.isArray(t);function f(_){var x=n(_,i);u?(s=!0,t.set(x)):x.forEach((w,b)=>{s=!0,t[b].set(w)}),s=!1}var g=!1;function m(_){var x,w,b,S;if(g){S=_(st(c)),o(S);return}var A=c.subscribe(N=>{g?x?w=!0:x=!0:b=N});S=_(b),g=!0,o(S),A(),g=!1,w&&(S=st(c)),x&&f(S)}return{subscribe:c.subscribe,set(_){m(()=>_)},update:m}}function Lo(t){let e,n,r=[t[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}],o={};for(let i=0;i<r.length;i+=1)o=Pt(o,r[i]);return{c(){e=Q("svg"),n=Q("path"),this.h()},l(i){e=Z(i,"svg",{fill:!0,viewBox:!0});var s=V(e);n=Z(s,"path",{fill:!0,stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(n).forEach(M),s.forEach(M),this.h()},h(){p(n,"fill","none"),p(n,"stroke","currentColor"),p(n,"stroke-linecap","round"),p(n,"stroke-linejoin","round"),p(n,"stroke-width","32"),p(n,"d","M413.66 246.1H386a2 2 0 0 1-2-2v-77.24A38.86 38.86 0 0 0 345.14 128H267.9a2 2 0 0 1-2-2V98.34c0-27.14-21.5-49.86-48.64-50.33a49.53 49.53 0 0 0-50.4 49.51V126a2 2 0 0 1-2 2H87.62A39.74 39.74 0 0 0 48 167.62V238a2 2 0 0 0 2 2h26.91c29.37 0 53.68 25.48 54.09 54.85.42 29.87-23.51 57.15-53.29 57.15H50a2 2 0 0 0-2 2v70.38A39.74 39.74 0 0 0 87.62 464H158a2 2 0 0 0 2-2v-20.93c0-30.28 24.75-56.35 55-57.06 30.1-.7 57 20.31 57 50.28V462a2 2 0 0 0 2 2h71.14A38.86 38.86 0 0 0 384 425.14v-78a2 2 0 0 1 2-2h28.48c27.63 0 49.52-22.67 49.52-50.4s-23.2-48.64-50.34-48.64z"),Wt(e,o)},m(i,s){U(i,e,s),G(e,n)},p(i,[s]){Wt(e,o=We(r,[s&1&&i[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}]))},i:ct,o:ct,d(i){i&&M(e)}}}function Ro(t,e,n){return t.$$set=r=>{n(0,e=Pt(Pt({},e),Kt(r)))},e=Kt(e),[e]}class zo extends dt{constructor(e){super(),gt(this,e,Ro,Lo,pt,{})}}function Bo(t){let e,n,r=[t[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}],o={};for(let i=0;i<r.length;i+=1)o=Pt(o,r[i]);return{c(){e=Q("svg"),n=Q("path"),this.h()},l(i){e=Z(i,"svg",{fill:!0,viewBox:!0});var s=V(e);n=Z(s,"path",{fill:!0,stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(n).forEach(M),s.forEach(M),this.h()},h(){p(n,"fill","none"),p(n,"stroke","currentColor"),p(n,"stroke-linecap","round"),p(n,"stroke-linejoin","round"),p(n,"stroke-width","32"),p(n,"d","M32 144h448M112 256h288M208 368h96"),Wt(e,o)},m(i,s){U(i,e,s),G(e,n)},p(i,[s]){Wt(e,o=We(r,[s&1&&i[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}]))},i:ct,o:ct,d(i){i&&M(e)}}}function Xo(t,e,n){return t.$$set=r=>{n(0,e=Pt(Pt({},e),Kt(r)))},e=Kt(e),[e]}class Do extends dt{constructor(e){super(),gt(this,e,Xo,Bo,pt,{})}}function Yo(t){let e,n,r,o=[t[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}],i={};for(let s=0;s<o.length;s+=1)i=Pt(i,o[s]);return{c(){e=Q("svg"),n=Q("path"),r=Q("circle"),this.h()},l(s){e=Z(s,"svg",{fill:!0,viewBox:!0});var l=V(e);n=Z(l,"path",{fill:!0,stroke:!0,"stroke-linecap":!0,"stroke-miterlimit":!0,"stroke-width":!0,d:!0}),V(n).forEach(M),r=Z(l,"circle",{cx:!0,cy:!0,r:!0}),V(r).forEach(M),l.forEach(M),this.h()},h(){p(n,"fill","none"),p(n,"stroke","currentColor"),p(n,"stroke-linecap","round"),p(n,"stroke-miterlimit","10"),p(n,"stroke-width","40"),p(n,"d","M160 164s1.44-33 33.54-59.46C212.6 88.83 235.49 84.28 256 84c18.73-.23 35.47 2.94 45.48 7.82C318.59 100.2 352 120.6 352 164c0 45.67-29.18 66.37-62.35 89.18S248 298.36 248 324"),p(r,"cx","248"),p(r,"cy","399.99"),p(r,"r","32"),Wt(e,i)},m(s,l){U(s,e,l),G(e,n),G(e,r)},p(s,[l]){Wt(e,i=We(o,[l&1&&s[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}]))},i:ct,o:ct,d(s){s&&M(e)}}}function Fo(t,e,n){return t.$$set=r=>{n(0,e=Pt(Pt({},e),Kt(r)))},e=Kt(e),[e]}class Dr extends dt{constructor(e){super(),gt(this,e,Fo,Yo,pt,{})}}function Vo(t){let e,n,r,o,i=[t[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}],s={};for(let l=0;l<i.length;l+=1)s=Pt(s,i[l]);return{c(){e=Q("svg"),n=Q("path"),r=Q("path"),o=Q("path"),this.h()},l(l){e=Z(l,"svg",{fill:!0,viewBox:!0});var a=V(e);n=Z(a,"path",{fill:!0,stroke:!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(n).forEach(M),r=Z(a,"path",{fill:!0,stroke:!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(r).forEach(M),o=Z(a,"path",{fill:!0,stroke:!0,"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),V(o).forEach(M),a.forEach(M),this.h()},h(){p(n,"fill","none"),p(n,"stroke","currentColor"),p(n,"stroke-linejoin","round"),p(n,"stroke-width","32"),p(n,"d","M160 336V48l32 16 32-16 31.94 16 32.37-16L320 64l31.79-16 31.93 16L416 48l32.01 16L480 48v224"),p(r,"fill","none"),p(r,"stroke","currentColor"),p(r,"stroke-linejoin","round"),p(r,"stroke-width","32"),p(r,"d","M480 272v112a80 80 0 0 1-80 80 80 80 0 0 1-80-80v-48H48a15.86 15.86 0 0 0-16 16c0 64 6.74 112 80 112h288"),p(o,"fill","none"),p(o,"stroke","currentColor"),p(o,"stroke-linecap","round"),p(o,"stroke-linejoin","round"),p(o,"stroke-width","32"),p(o,"d","M224 144h192m-128 80h128"),Wt(e,s)},m(l,a){U(l,e,a),G(e,n),G(e,r),G(e,o)},p(l,[a]){Wt(e,s=We(i,[a&1&&l[0],{fill:"currentColor"},{viewBox:"0 0 512 512"}]))},i:ct,o:ct,d(l){l&&M(e)}}}function Ho(t,e,n){return t.$$set=r=>{n(0,e=Pt(Pt({},e),Kt(r)))},e=Kt(e),[e]}class qo extends dt{constructor(e){super(),gt(this,e,Ho,Vo,pt,{})}}function he(t,e){const r=st(t.potentialAnchorsStore)[e];if(r===void 0)throw"potential anchor not found";return r}function Yr(t,e){let n=Object.values(st(t.potentialAnchorsStore));return e!==void 0&&(n=n.filter(r=>{for(let o in e){const i=e[o];if(r[o]!==i)return!1}return!0})),n}function ae(t,e){let n=Object.values(st(t.anchorsStore));return e!==void 0&&(n=n.filter(r=>{for(let o in e){const i=e[o];if(r[o]!==i)return!1}return!0})),n}function re(t,e,n){De(t,e);const r=ae(t,{edgeId:e});if(r.length!==2)throw`there should be two anchors for a given edge, there are ${r.length}`;const o=r.filter(i=>i.sourceOrTarget===n);if(o.length!==1)throw"there should only be one source/target anchor";return o[0]}function De(t,e){const r=st(t.edgesStore)[e];if(r===void 0)throw"edge not found";return r}let En=class{constructor(e,n,r,o,i,s,l,a,c,u,f,g,m){this.id=e,this.icon=n,this.component=r,this.label=o,this.bgColor=i,this.inPorts=s,this.outPorts=l,this.positionX=a,this.positionY=c,this.height=u,this.width=f,this.canvasId=g,this.clickCallback=m}setPositionFromMovement(e,n){const{nodesStore:r,anchorsStore:o,potentialAnchorsStore:i}=It[this.canvasId];this.positionX+=e,this.positionY+=n,o.update(s=>{for(const l in s)s[l].nodeId===this.id&&s[l].setPositionFromNode();return{...s}}),i.update(s=>{for(const l in s)s[l].nodeId===this.id&&s[l].callback();return{...s}})}delete(){const e=It[this.canvasId],{nodesStore:n,anchorsStore:r,edgesStore:o}=It[this.canvasId];n.update(l=>{for(const a in l)l[a].id===this.id&&delete l[a];return{...l}});const i=ae(e,{nodeId:this.id});for(let l of i){const a=l.edgeId;De(e,a).delete()}const s=Yr(e,{nodeId:this.id});for(const l of s)l.delete()}};function Go(t,e){function n(o){const i={},s=st(t.loaderStore);if(o.processes===void 0)return i;for(const[l,a]of Object.entries(o.processes)){const c=s(a.component);if(c&&a.metadata!==void 0){let u=Math.max(c.inPorts.length,c.outPorts.length)-3;const f=a.metadata,g=new En(l,c.icon===void 0?Dr:c.icon,a.component,f.label===void 0?"":f.label,f.bgColor===void 0?"default":f.bgColor,c.inPorts,c.outPorts,f.x,f.y,u>0?60+u*17.5:60,60,e,()=>{});i[l]=g}}return i}function r(o,i){i.processes={};for(const[s,l]of Object.entries(o)){const a={x:l.positionX,y:l.positionY,label:l.label};i.processes[s]={component:l.component,metadata:a}}return i}t.nodesStore=Oo(t.graphStore,n,r)}const jo={init:Go};function At(t){return It[t]}function Uo(t){return It[t]={graphStore:_t(new Mo.Graph().toJSON()),loaderStore:_t(e=>null),themeStore:_t("dark"),nodesStore:_t({}),edgesStore:_t({}),anchorsStore:_t({}),potentialAnchorsStore:_t({}),widthStore:_t(600),heightStore:_t(600),backgroundStore:_t(!1),movementStore:_t(!0),nodeSelected:_t(!1),nodeIdSelected:_t(-1),d3Scale:_t(1),options:_t({}),temporaryEdgeStore:_t([]),nodeCreate:_t(!1)},jo.init(It[t],t),It[t]}function ge(t,e){return st(t.nodesStore)[e]}function Wo(t,e,n){const o=st(t.loaderStore)(n);if(!o)return!1;const i=st(t.nodesStore);let s=Math.round(Math.random()*1e5).toString(36);for(;Object.keys(i).some(c=>c===s);)s=Math.round(Math.random()*1e5).toString(36);let l=Math.max(o.inPorts.length,o.outPorts.length)-3;const a=new En(s,o.icon===void 0?Dr:o.icon,n,n,"default",o.inPorts,o.outPorts,0,0,l>0?60+l*17.5:60,60,e,()=>{});return t.nodesStore.update(c=>(c[s]=a,c)),!0}var Ko={value:()=>{}};function xn(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Le(n)}function Le(t){this._=t}function Qo(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",o=n.indexOf(".");if(o>=0&&(r=n.slice(o+1),n=n.slice(0,o)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Le.prototype=xn.prototype={constructor:Le,on:function(t,e){var n=this._,r=Qo(t+"",n),o,i=-1,s=r.length;if(arguments.length<2){for(;++i<s;)if((o=(t=r[i]).type)&&(o=Zo(n[o],t.name)))return o;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++i<s;)if(o=(t=r[i]).type)n[o]=Fn(n[o],t.name,e);else if(e==null)for(o in n)n[o]=Fn(n[o],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Le(t)},call:function(t,e){if((o=arguments.length-2)>0)for(var n=new Array(o),r=0,o,i;r<o;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}};function Zo(t,e){for(var n=0,r=t.length,o;n<r;++n)if((o=t[n]).name===e)return o.value}function Fn(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=Ko,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var cn="http://www.w3.org/1999/xhtml";const Vn={svg:"http://www.w3.org/2000/svg",xhtml:cn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ze(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),Vn.hasOwnProperty(e)?{space:Vn[e],local:t}:t}function Jo(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===cn&&e.documentElement.namespaceURI===cn?e.createElement(t):e.createElementNS(n,t)}}function $o(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Fr(t){var e=Ze(t);return(e.local?$o:Jo)(e)}function ti(){}function Sn(t){return t==null?ti:function(){return this.querySelector(t)}}function ei(t){typeof t!="function"&&(t=Sn(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,l=r[o]=new Array(s),a,c,u=0;u<s;++u)(a=i[u])&&(c=t.call(a,a.__data__,u,i))&&("__data__"in a&&(c.__data__=a.__data__),l[u]=c);return new bt(r,this._parents)}function Vr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function ni(){return[]}function Hr(t){return t==null?ni:function(){return this.querySelectorAll(t)}}function ri(t){return function(){return Vr(t.apply(this,arguments))}}function oi(t){typeof t=="function"?t=ri(t):t=Hr(t);for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var s=e[i],l=s.length,a,c=0;c<l;++c)(a=s[c])&&(r.push(t.call(a,a.__data__,c,s)),o.push(a));return new bt(r,o)}function qr(t){return function(){return this.matches(t)}}function Gr(t){return function(e){return e.matches(t)}}var ii=Array.prototype.find;function si(t){return function(){return ii.call(this.children,t)}}function ai(){return this.firstElementChild}function li(t){return this.select(t==null?ai:si(typeof t=="function"?t:Gr(t)))}var ci=Array.prototype.filter;function ui(){return Array.from(this.children)}function fi(t){return function(){return ci.call(this.children,t)}}function hi(t){return this.selectAll(t==null?ui:fi(typeof t=="function"?t:Gr(t)))}function di(t){typeof t!="function"&&(t=qr(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,l=r[o]=[],a,c=0;c<s;++c)(a=i[c])&&t.call(a,a.__data__,c,i)&&l.push(a);return new bt(r,this._parents)}function jr(t){return new Array(t.length)}function gi(){return new bt(this._enter||this._groups.map(jr),this._parents)}function Ye(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ye.prototype={constructor:Ye,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function pi(t){return function(){return t}}function mi(t,e,n,r,o,i){for(var s=0,l,a=e.length,c=i.length;s<c;++s)(l=e[s])?(l.__data__=i[s],r[s]=l):n[s]=new Ye(t,i[s]);for(;s<a;++s)(l=e[s])&&(o[s]=l)}function _i(t,e,n,r,o,i,s){var l,a,c=new Map,u=e.length,f=i.length,g=new Array(u),m;for(l=0;l<u;++l)(a=e[l])&&(g[l]=m=s.call(a,a.__data__,l,e)+"",c.has(m)?o[l]=a:c.set(m,a));for(l=0;l<f;++l)m=s.call(t,i[l],l,i)+"",(a=c.get(m))?(r[l]=a,a.__data__=i[l],c.delete(m)):n[l]=new Ye(t,i[l]);for(l=0;l<u;++l)(a=e[l])&&c.get(g[l])===a&&(o[l]=a)}function vi(t){return t.__data__}function yi(t,e){if(!arguments.length)return Array.from(this,vi);var n=e?_i:mi,r=this._parents,o=this._groups;typeof t!="function"&&(t=pi(t));for(var i=o.length,s=new Array(i),l=new Array(i),a=new Array(i),c=0;c<i;++c){var u=r[c],f=o[c],g=f.length,m=wi(t.call(u,u&&u.__data__,c,r)),_=m.length,x=l[c]=new Array(_),w=s[c]=new Array(_),b=a[c]=new Array(g);n(u,f,x,w,b,m,e);for(var S=0,A=0,N,d;S<_;++S)if(N=x[S]){for(S>=A&&(A=S+1);!(d=w[A])&&++A<_;);N._next=d||null}}return s=new bt(s,r),s._enter=l,s._exit=a,s}function wi(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function bi(){return new bt(this._exit||this._groups.map(jr),this._parents)}function ki(t,e,n){var r=this.enter(),o=this,i=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(o=e(o),o&&(o=o.selection())),n==null?i.remove():n(i),r&&o?r.merge(o).order():o}function Ei(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,o=n.length,i=r.length,s=Math.min(o,i),l=new Array(o),a=0;a<s;++a)for(var c=n[a],u=r[a],f=c.length,g=l[a]=new Array(f),m,_=0;_<f;++_)(m=c[_]||u[_])&&(g[_]=m);for(;a<o;++a)l[a]=n[a];return new bt(l,this._parents)}function xi(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],o=r.length-1,i=r[o],s;--o>=0;)(s=r[o])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function Si(t){t||(t=Ii);function e(f,g){return f&&g?t(f.__data__,g.__data__):!f-!g}for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var s=n[i],l=s.length,a=o[i]=new Array(l),c,u=0;u<l;++u)(c=s[u])&&(a[u]=c);a.sort(e)}return new bt(o,this._parents).order()}function Ii(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ni(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Ti(){return Array.from(this)}function Pi(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var s=r[o];if(s)return s}return null}function Ai(){let t=0;for(const e of this)++t;return t}function Ci(){return!this.node()}function Mi(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o=e[n],i=0,s=o.length,l;i<s;++i)(l=o[i])&&t.call(l,l.__data__,i,o);return this}function Oi(t){return function(){this.removeAttribute(t)}}function Li(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ri(t,e){return function(){this.setAttribute(t,e)}}function zi(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Bi(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function Xi(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function Di(t,e){var n=Ze(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Li:Oi:typeof e=="function"?n.local?Xi:Bi:n.local?zi:Ri)(n,e))}function Ur(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Yi(t){return function(){this.style.removeProperty(t)}}function Fi(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Vi(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Hi(t,e,n){return arguments.length>1?this.each((e==null?Yi:typeof e=="function"?Vi:Fi)(t,e,n??"")):oe(this.node(),t)}function oe(t,e){return t.style.getPropertyValue(e)||Ur(t).getComputedStyle(t,null).getPropertyValue(e)}function qi(t){return function(){delete this[t]}}function Gi(t,e){return function(){this[t]=e}}function ji(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function Ui(t,e){return arguments.length>1?this.each((e==null?qi:typeof e=="function"?ji:Gi)(t,e)):this.node()[t]}function Wr(t){return t.trim().split(/^|\s+/)}function In(t){return t.classList||new Kr(t)}function Kr(t){this._node=t,this._names=Wr(t.getAttribute("class")||"")}Kr.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Qr(t,e){for(var n=In(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function Zr(t,e){for(var n=In(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function Wi(t){return function(){Qr(this,t)}}function Ki(t){return function(){Zr(this,t)}}function Qi(t,e){return function(){(e.apply(this,arguments)?Qr:Zr)(this,t)}}function Zi(t,e){var n=Wr(t+"");if(arguments.length<2){for(var r=In(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each((typeof e=="function"?Qi:e?Wi:Ki)(n,e))}function Ji(){this.textContent=""}function $i(t){return function(){this.textContent=t}}function ts(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function es(t){return arguments.length?this.each(t==null?Ji:(typeof t=="function"?ts:$i)(t)):this.node().textContent}function ns(){this.innerHTML=""}function rs(t){return function(){this.innerHTML=t}}function os(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function is(t){return arguments.length?this.each(t==null?ns:(typeof t=="function"?os:rs)(t)):this.node().innerHTML}function ss(){this.nextSibling&&this.parentNode.appendChild(this)}function as(){return this.each(ss)}function ls(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function cs(){return this.each(ls)}function us(t){var e=typeof t=="function"?t:Fr(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function fs(){return null}function hs(t,e){var n=typeof t=="function"?t:Fr(t),r=e==null?fs:typeof e=="function"?e:Sn(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ds(){var t=this.parentNode;t&&t.removeChild(this)}function gs(){return this.each(ds)}function ps(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ms(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function _s(t){return this.select(t?ms:ps)}function vs(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ys(t){return function(e){t.call(this,e,this.__data__)}}function ws(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function bs(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,o=e.length,i;n<o;++n)i=e[n],(!t.type||i.type===t.type)&&i.name===t.name?this.removeEventListener(i.type,i.listener,i.options):e[++r]=i;++r?e.length=r:delete this.__on}}}function ks(t,e,n){return function(){var r=this.__on,o,i=ys(e);if(r){for(var s=0,l=r.length;s<l;++s)if((o=r[s]).type===t.type&&o.name===t.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=e;return}}this.addEventListener(t.type,i,n),o={type:t.type,name:t.name,value:e,listener:i,options:n},r?r.push(o):this.__on=[o]}}function Es(t,e,n){var r=ws(t+""),o,i=r.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var a=0,c=l.length,u;a<c;++a)for(o=0,u=l[a];o<i;++o)if((s=r[o]).type===u.type&&s.name===u.name)return u.value}return}for(l=e?ks:bs,o=0;o<i;++o)this.each(l(r[o],e,n));return this}function Jr(t,e,n){var r=Ur(t),o=r.CustomEvent;typeof o=="function"?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function xs(t,e){return function(){return Jr(this,t,e)}}function Ss(t,e){return function(){return Jr(this,t,e.apply(this,arguments))}}function Is(t,e){return this.each((typeof e=="function"?Ss:xs)(t,e))}function*Ns(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length,s;o<i;++o)(s=r[o])&&(yield s)}var Nn=[null];function bt(t,e){this._groups=t,this._parents=e}function ye(){return new bt([[document.documentElement]],Nn)}function Ts(){return this}bt.prototype=ye.prototype={constructor:bt,select:ei,selectAll:oi,selectChild:li,selectChildren:hi,filter:di,data:yi,enter:gi,exit:bi,join:ki,merge:Ei,selection:Ts,order:xi,sort:Si,call:Ni,nodes:Ti,node:Pi,size:Ai,empty:Ci,each:Mi,attr:Di,style:Hi,property:Ui,classed:Zi,text:es,html:is,raise:as,lower:cs,append:us,insert:hs,remove:gs,clone:_s,datum:vs,on:Es,dispatch:Is,[Symbol.iterator]:Ns};function qt(t){return typeof t=="string"?new bt([[document.querySelector(t)]],[document.documentElement]):new bt([[t]],Nn)}function Ps(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Ft(t,e){if(t=Ps(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var o=e.getBoundingClientRect();return[t.clientX-o.left-e.clientLeft,t.clientY-o.top-e.clientTop]}}return[t.pageX,t.pageY]}function As(t){return typeof t=="string"?new bt([document.querySelectorAll(t)],[document.documentElement]):new bt([Vr(t)],Nn)}const un={capture:!0,passive:!1};function fn(t){t.preventDefault(),t.stopImmediatePropagation()}function Cs(t){var e=t.document.documentElement,n=qt(t).on("dragstart.drag",fn,un);"onselectstart"in e?n.on("selectstart.drag",fn,un):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ms(t,e){var n=t.document.documentElement,r=qt(t).on("dragstart.drag",null);e&&(r.on("click.drag",fn,un),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function Tn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function $r(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function we(){}var pe=.7,Fe=1/pe,ne="\\s*([+-]?\\d+)\\s*",me="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Os=/^#([0-9a-f]{3,8})$/,Ls=new RegExp(`^rgb\\(${ne},${ne},${ne}\\)$`),Rs=new RegExp(`^rgb\\(${zt},${zt},${zt}\\)$`),zs=new RegExp(`^rgba\\(${ne},${ne},${ne},${me}\\)$`),Bs=new RegExp(`^rgba\\(${zt},${zt},${zt},${me}\\)$`),Xs=new RegExp(`^hsl\\(${me},${zt},${zt}\\)$`),Ds=new RegExp(`^hsla\\(${me},${zt},${zt},${me}\\)$`),Hn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Tn(we,_e,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:qn,formatHex:qn,formatHex8:Ys,formatHsl:Fs,formatRgb:Gn,toString:Gn});function qn(){return this.rgb().formatHex()}function Ys(){return this.rgb().formatHex8()}function Fs(){return to(this).formatHsl()}function Gn(){return this.rgb().formatRgb()}function _e(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Os.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?jn(e):n===3?new kt(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ee(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ee(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Ls.exec(t))?new kt(e[1],e[2],e[3],1):(e=Rs.exec(t))?new kt(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=zs.exec(t))?Ee(e[1],e[2],e[3],e[4]):(e=Bs.exec(t))?Ee(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=Xs.exec(t))?Kn(e[1],e[2]/100,e[3]/100,1):(e=Ds.exec(t))?Kn(e[1],e[2]/100,e[3]/100,e[4]):Hn.hasOwnProperty(t)?jn(Hn[t]):t==="transparent"?new kt(NaN,NaN,NaN,0):null}function jn(t){return new kt(t>>16&255,t>>8&255,t&255,1)}function Ee(t,e,n,r){return r<=0&&(t=e=n=NaN),new kt(t,e,n,r)}function Vs(t){return t instanceof we||(t=_e(t)),t?(t=t.rgb(),new kt(t.r,t.g,t.b,t.opacity)):new kt}function hn(t,e,n,r){return arguments.length===1?Vs(t):new kt(t,e,n,r??1)}function kt(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Tn(kt,hn,$r(we,{brighter(t){return t=t==null?Fe:Math.pow(Fe,t),new kt(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?pe:Math.pow(pe,t),new kt(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new kt(Jt(this.r),Jt(this.g),Jt(this.b),Ve(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Un,formatHex:Un,formatHex8:Hs,formatRgb:Wn,toString:Wn}));function Un(){return`#${Zt(this.r)}${Zt(this.g)}${Zt(this.b)}`}function Hs(){return`#${Zt(this.r)}${Zt(this.g)}${Zt(this.b)}${Zt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wn(){const t=Ve(this.opacity);return`${t===1?"rgb(":"rgba("}${Jt(this.r)}, ${Jt(this.g)}, ${Jt(this.b)}${t===1?")":`, ${t})`}`}function Ve(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Jt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Zt(t){return t=Jt(t),(t<16?"0":"")+t.toString(16)}function Kn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Mt(t,e,n,r)}function to(t){if(t instanceof Mt)return new Mt(t.h,t.s,t.l,t.opacity);if(t instanceof we||(t=_e(t)),!t)return new Mt;if(t instanceof Mt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,o=Math.min(e,n,r),i=Math.max(e,n,r),s=NaN,l=i-o,a=(i+o)/2;return l?(e===i?s=(n-r)/l+(n<r)*6:n===i?s=(r-e)/l+2:s=(e-n)/l+4,l/=a<.5?i+o:2-i-o,s*=60):l=a>0&&a<1?0:s,new Mt(s,l,a,t.opacity)}function qs(t,e,n,r){return arguments.length===1?to(t):new Mt(t,e,n,r??1)}function Mt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Tn(Mt,qs,$r(we,{brighter(t){return t=t==null?Fe:Math.pow(Fe,t),new Mt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?pe:Math.pow(pe,t),new Mt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,o=2*n-r;return new kt(rn(t>=240?t-240:t+120,o,r),rn(t,o,r),rn(t<120?t+240:t-120,o,r),this.opacity)},clamp(){return new Mt(Qn(this.h),xe(this.s),xe(this.l),Ve(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ve(this.opacity);return`${t===1?"hsl(":"hsla("}${Qn(this.h)}, ${xe(this.s)*100}%, ${xe(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Qn(t){return t=(t||0)%360,t<0?t+360:t}function xe(t){return Math.max(0,Math.min(1,t||0))}function rn(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const eo=t=>()=>t;function Gs(t,e){return function(n){return t+n*e}}function js(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Us(t){return(t=+t)==1?no:function(e,n){return n-e?js(e,n,t):eo(isNaN(e)?n:e)}}function no(t,e){var n=e-t;return n?Gs(t,n):eo(isNaN(t)?e:t)}const Zn=function t(e){var n=Us(e);function r(o,i){var s=n((o=hn(o)).r,(i=hn(i)).r),l=n(o.g,i.g),a=n(o.b,i.b),c=no(o.opacity,i.opacity);return function(u){return o.r=s(u),o.g=l(u),o.b=a(u),o.opacity=c(u),o+""}}return r.gamma=t,r}(1);function Vt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var dn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,on=new RegExp(dn.source,"g");function Ws(t){return function(){return t}}function Ks(t){return function(e){return t(e)+""}}function Qs(t,e){var n=dn.lastIndex=on.lastIndex=0,r,o,i,s=-1,l=[],a=[];for(t=t+"",e=e+"";(r=dn.exec(t))&&(o=on.exec(e));)(i=o.index)>n&&(i=e.slice(n,i),l[s]?l[s]+=i:l[++s]=i),(r=r[0])===(o=o[0])?l[s]?l[s]+=o:l[++s]=o:(l[++s]=null,a.push({i:s,x:Vt(r,o)})),n=on.lastIndex;return n<e.length&&(i=e.slice(n),l[s]?l[s]+=i:l[++s]=i),l.length<2?a[0]?Ks(a[0].x):Ws(e):(e=a.length,function(c){for(var u=0,f;u<e;++u)l[(f=a[u]).i]=f.x(c);return l.join("")})}var Jn=180/Math.PI,gn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ro(t,e,n,r,o,i){var s,l,a;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(a=t*n+e*r)&&(n-=t*a,r-=e*a),(l=Math.sqrt(n*n+r*r))&&(n/=l,r/=l,a/=l),t*r<e*n&&(t=-t,e=-e,a=-a,s=-s),{translateX:o,translateY:i,rotate:Math.atan2(e,t)*Jn,skewX:Math.atan(a)*Jn,scaleX:s,scaleY:l}}var Se;function Zs(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?gn:ro(e.a,e.b,e.c,e.d,e.e,e.f)}function Js(t){return t==null||(Se||(Se=document.createElementNS("http://www.w3.org/2000/svg","g")),Se.setAttribute("transform",t),!(t=Se.transform.baseVal.consolidate()))?gn:(t=t.matrix,ro(t.a,t.b,t.c,t.d,t.e,t.f))}function oo(t,e,n,r){function o(c){return c.length?c.pop()+" ":""}function i(c,u,f,g,m,_){if(c!==f||u!==g){var x=m.push("translate(",null,e,null,n);_.push({i:x-4,x:Vt(c,f)},{i:x-2,x:Vt(u,g)})}else(f||g)&&m.push("translate("+f+e+g+n)}function s(c,u,f,g){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),g.push({i:f.push(o(f)+"rotate(",null,r)-2,x:Vt(c,u)})):u&&f.push(o(f)+"rotate("+u+r)}function l(c,u,f,g){c!==u?g.push({i:f.push(o(f)+"skewX(",null,r)-2,x:Vt(c,u)}):u&&f.push(o(f)+"skewX("+u+r)}function a(c,u,f,g,m,_){if(c!==f||u!==g){var x=m.push(o(m)+"scale(",null,",",null,")");_.push({i:x-4,x:Vt(c,f)},{i:x-2,x:Vt(u,g)})}else(f!==1||g!==1)&&m.push(o(m)+"scale("+f+","+g+")")}return function(c,u){var f=[],g=[];return c=t(c),u=t(u),i(c.translateX,c.translateY,u.translateX,u.translateY,f,g),s(c.rotate,u.rotate,f,g),l(c.skewX,u.skewX,f,g),a(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,g),c=u=null,function(m){for(var _=-1,x=g.length,w;++_<x;)f[(w=g[_]).i]=w.x(m);return f.join("")}}}var $s=oo(Zs,"px, ","px)","deg)"),ta=oo(Js,", ",")",")"),ea=1e-12;function $n(t){return((t=Math.exp(t))+1/t)/2}function na(t){return((t=Math.exp(t))-1/t)/2}function ra(t){return((t=Math.exp(2*t))-1)/(t+1)}const oa=function t(e,n,r){function o(i,s){var l=i[0],a=i[1],c=i[2],u=s[0],f=s[1],g=s[2],m=u-l,_=f-a,x=m*m+_*_,w,b;if(x<ea)b=Math.log(g/c)/e,w=function(E){return[l+E*m,a+E*_,c*Math.exp(e*E*b)]};else{var S=Math.sqrt(x),A=(g*g-c*c+r*x)/(2*c*n*S),N=(g*g-c*c-r*x)/(2*g*n*S),d=Math.log(Math.sqrt(A*A+1)-A),h=Math.log(Math.sqrt(N*N+1)-N);b=(h-d)/e,w=function(E){var I=E*b,k=$n(d),z=c/(n*S)*(k*ra(e*I+d)-na(d));return[l+z*m,a+z*_,c*k/$n(e*I+d)]}}return w.duration=b*1e3*e/Math.SQRT2,w}return o.rho=function(i){var s=Math.max(.001,+i),l=s*s,a=l*l;return t(s,l,a)},o}(Math.SQRT2,2,4);var ie=0,ue=0,le=0,io=1e3,He,fe,qe=0,$t=0,Je=0,ve=typeof performance=="object"&&performance.now?performance:Date,so=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Pn(){return $t||(so(ia),$t=ve.now()+Je)}function ia(){$t=0}function Ge(){this._call=this._time=this._next=null}Ge.prototype=ao.prototype={constructor:Ge,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Pn():+n)+(e==null?0:+e),!this._next&&fe!==this&&(fe?fe._next=this:He=this,fe=this),this._call=t,this._time=n,pn()},stop:function(){this._call&&(this._call=null,this._time=1/0,pn())}};function ao(t,e,n){var r=new Ge;return r.restart(t,e,n),r}function sa(){Pn(),++ie;for(var t=He,e;t;)(e=$t-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ie}function tr(){$t=(qe=ve.now())+Je,ie=ue=0;try{sa()}finally{ie=0,la(),$t=0}}function aa(){var t=ve.now(),e=t-qe;e>io&&(Je-=e,qe=t)}function la(){for(var t,e=He,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:He=n);fe=t,pn(r)}function pn(t){if(!ie){ue&&(ue=clearTimeout(ue));var e=t-$t;e>24?(t<1/0&&(ue=setTimeout(tr,t-ve.now()-Je)),le&&(le=clearInterval(le))):(le||(qe=ve.now(),le=setInterval(aa,io)),ie=1,so(tr))}}function er(t,e,n){var r=new Ge;return e=e==null?0:+e,r.restart(o=>{r.stop(),t(o+e)},e,n),r}var ca=xn("start","end","cancel","interrupt"),ua=[],lo=0,nr=1,mn=2,Re=3,rr=4,_n=5,ze=6;function $e(t,e,n,r,o,i){var s=t.__transition;if(!s)t.__transition={};else if(n in s)return;fa(t,n,{name:e,index:r,group:o,on:ca,tween:ua,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:lo})}function An(t,e){var n=Ot(t,e);if(n.state>lo)throw new Error("too late; already scheduled");return n}function Bt(t,e){var n=Ot(t,e);if(n.state>Re)throw new Error("too late; already running");return n}function Ot(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function fa(t,e,n){var r=t.__transition,o;r[e]=n,n.timer=ao(i,0,n.time);function i(c){n.state=nr,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,f,g,m;if(n.state!==nr)return a();for(u in r)if(m=r[u],m.name===n.name){if(m.state===Re)return er(s);m.state===rr?(m.state=ze,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[u]):+u<e&&(m.state=ze,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[u])}if(er(function(){n.state===Re&&(n.state=rr,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=mn,n.on.call("start",t,t.__data__,n.index,n.group),n.state===mn){for(n.state=Re,o=new Array(g=n.tween.length),u=0,f=-1;u<g;++u)(m=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(o[++f]=m);o.length=f+1}}function l(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(a),n.state=_n,1),f=-1,g=o.length;++f<g;)o[f].call(t,u);n.state===_n&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){n.state=ze,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Be(t,e){var n=t.__transition,r,o,i=!0,s;if(n){e=e==null?null:e+"";for(s in n){if((r=n[s]).name!==e){i=!1;continue}o=r.state>mn&&r.state<_n,r.state=ze,r.timer.stop(),r.on.call(o?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[s]}i&&delete t.__transition}}function ha(t){return this.each(function(){Be(this,t)})}function da(t,e){var n,r;return function(){var o=Bt(this,t),i=o.tween;if(i!==n){r=n=i;for(var s=0,l=r.length;s<l;++s)if(r[s].name===e){r=r.slice(),r.splice(s,1);break}}o.tween=r}}function ga(t,e,n){var r,o;if(typeof n!="function")throw new Error;return function(){var i=Bt(this,t),s=i.tween;if(s!==r){o=(r=s).slice();for(var l={name:e,value:n},a=0,c=o.length;a<c;++a)if(o[a].name===e){o[a]=l;break}a===c&&o.push(l)}i.tween=o}}function pa(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Ot(this.node(),n).tween,o=0,i=r.length,s;o<i;++o)if((s=r[o]).name===t)return s.value;return null}return this.each((e==null?da:ga)(n,t,e))}function Cn(t,e,n){var r=t._id;return t.each(function(){var o=Bt(this,r);(o.value||(o.value={}))[e]=n.apply(this,arguments)}),function(o){return Ot(o,r).value[e]}}function co(t,e){var n;return(typeof e=="number"?Vt:e instanceof _e?Zn:(n=_e(e))?(e=n,Zn):Qs)(t,e)}function ma(t){return function(){this.removeAttribute(t)}}function _a(t){return function(){this.removeAttributeNS(t.space,t.local)}}function va(t,e,n){var r,o=n+"",i;return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function ya(t,e,n){var r,o=n+"",i;return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function wa(t,e,n){var r,o,i;return function(){var s,l=n(this),a;return l==null?void this.removeAttribute(t):(s=this.getAttribute(t),a=l+"",s===a?null:s===r&&a===o?i:(o=a,i=e(r=s,l)))}}function ba(t,e,n){var r,o,i;return function(){var s,l=n(this),a;return l==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),a=l+"",s===a?null:s===r&&a===o?i:(o=a,i=e(r=s,l)))}}function ka(t,e){var n=Ze(t),r=n==="transform"?ta:co;return this.attrTween(t,typeof e=="function"?(n.local?ba:wa)(n,r,Cn(this,"attr."+t,e)):e==null?(n.local?_a:ma)(n):(n.local?ya:va)(n,r,e))}function Ea(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function xa(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Sa(t,e){var n,r;function o(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&xa(t,i)),n}return o._value=e,o}function Ia(t,e){var n,r;function o(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&Ea(t,i)),n}return o._value=e,o}function Na(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Ze(t);return this.tween(n,(r.local?Sa:Ia)(r,e))}function Ta(t,e){return function(){An(this,t).delay=+e.apply(this,arguments)}}function Pa(t,e){return e=+e,function(){An(this,t).delay=e}}function Aa(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ta:Pa)(e,t)):Ot(this.node(),e).delay}function Ca(t,e){return function(){Bt(this,t).duration=+e.apply(this,arguments)}}function Ma(t,e){return e=+e,function(){Bt(this,t).duration=e}}function Oa(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Ca:Ma)(e,t)):Ot(this.node(),e).duration}function La(t,e){if(typeof e!="function")throw new Error;return function(){Bt(this,t).ease=e}}function Ra(t){var e=this._id;return arguments.length?this.each(La(e,t)):Ot(this.node(),e).ease}function za(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Bt(this,t).ease=n}}function Ba(t){if(typeof t!="function")throw new Error;return this.each(za(this._id,t))}function Xa(t){typeof t!="function"&&(t=qr(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i=e[o],s=i.length,l=r[o]=[],a,c=0;c<s;++c)(a=i[c])&&t.call(a,a.__data__,c,i)&&l.push(a);return new Yt(r,this._parents,this._name,this._id)}function Da(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),s=new Array(r),l=0;l<i;++l)for(var a=e[l],c=n[l],u=a.length,f=s[l]=new Array(u),g,m=0;m<u;++m)(g=a[m]||c[m])&&(f[m]=g);for(;l<r;++l)s[l]=e[l];return new Yt(s,this._parents,this._name,this._id)}function Ya(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function Fa(t,e,n){var r,o,i=Ya(e)?An:Bt;return function(){var s=i(this,t),l=s.on;l!==r&&(o=(r=l).copy()).on(e,n),s.on=o}}function Va(t,e){var n=this._id;return arguments.length<2?Ot(this.node(),n).on.on(t):this.each(Fa(n,t,e))}function Ha(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function qa(){return this.on("end.remove",Ha(this._id))}function Ga(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Sn(t));for(var r=this._groups,o=r.length,i=new Array(o),s=0;s<o;++s)for(var l=r[s],a=l.length,c=i[s]=new Array(a),u,f,g=0;g<a;++g)(u=l[g])&&(f=t.call(u,u.__data__,g,l))&&("__data__"in u&&(f.__data__=u.__data__),c[g]=f,$e(c[g],e,n,g,c,Ot(u,n)));return new Yt(i,this._parents,e,n)}function ja(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Hr(t));for(var r=this._groups,o=r.length,i=[],s=[],l=0;l<o;++l)for(var a=r[l],c=a.length,u,f=0;f<c;++f)if(u=a[f]){for(var g=t.call(u,u.__data__,f,a),m,_=Ot(u,n),x=0,w=g.length;x<w;++x)(m=g[x])&&$e(m,e,n,x,g,_);i.push(g),s.push(u)}return new Yt(i,s,e,n)}var Ua=ye.prototype.constructor;function Wa(){return new Ua(this._groups,this._parents)}function Ka(t,e){var n,r,o;return function(){var i=oe(this,t),s=(this.style.removeProperty(t),oe(this,t));return i===s?null:i===n&&s===r?o:o=e(n=i,r=s)}}function uo(t){return function(){this.style.removeProperty(t)}}function Qa(t,e,n){var r,o=n+"",i;return function(){var s=oe(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}function Za(t,e,n){var r,o,i;return function(){var s=oe(this,t),l=n(this),a=l+"";return l==null&&(a=l=(this.style.removeProperty(t),oe(this,t))),s===a?null:s===r&&a===o?i:(o=a,i=e(r=s,l))}}function Ja(t,e){var n,r,o,i="style."+e,s="end."+i,l;return function(){var a=Bt(this,t),c=a.on,u=a.value[i]==null?l||(l=uo(e)):void 0;(c!==n||o!==u)&&(r=(n=c).copy()).on(s,o=u),a.on=r}}function $a(t,e,n){var r=(t+="")=="transform"?$s:co;return e==null?this.styleTween(t,Ka(t,r)).on("end.style."+t,uo(t)):typeof e=="function"?this.styleTween(t,Za(t,r,Cn(this,"style."+t,e))).each(Ja(this._id,t)):this.styleTween(t,Qa(t,r,e),n).on("end.style."+t,null)}function tl(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function el(t,e,n){var r,o;function i(){var s=e.apply(this,arguments);return s!==o&&(r=(o=s)&&tl(t,s,n)),r}return i._value=e,i}function nl(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,el(t,e,n??""))}function rl(t){return function(){this.textContent=t}}function ol(t){return function(){var e=t(this);this.textContent=e??""}}function il(t){return this.tween("text",typeof t=="function"?ol(Cn(this,"text",t)):rl(t==null?"":t+""))}function sl(t){return function(e){this.textContent=t.call(this,e)}}function al(t){var e,n;function r(){var o=t.apply(this,arguments);return o!==n&&(e=(n=o)&&sl(o)),e}return r._value=t,r}function ll(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,al(t))}function cl(){for(var t=this._name,e=this._id,n=fo(),r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],l=s.length,a,c=0;c<l;++c)if(a=s[c]){var u=Ot(a,e);$e(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Yt(r,this._parents,t,n)}function ul(){var t,e,n=this,r=n._id,o=n.size();return new Promise(function(i,s){var l={value:s},a={value:function(){--o===0&&i()}};n.each(function(){var c=Bt(this,r),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(l),e._.interrupt.push(l),e._.end.push(a)),c.on=e}),o===0&&i()})}var fl=0;function Yt(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function fo(){return++fl}var Xt=ye.prototype;Yt.prototype={constructor:Yt,select:Ga,selectAll:ja,selectChild:Xt.selectChild,selectChildren:Xt.selectChildren,filter:Xa,merge:Da,selection:Wa,transition:cl,call:Xt.call,nodes:Xt.nodes,node:Xt.node,size:Xt.size,empty:Xt.empty,each:Xt.each,on:Va,attr:ka,attrTween:Na,style:$a,styleTween:nl,text:il,textTween:ll,remove:qa,tween:pa,delay:Aa,duration:Oa,ease:Ra,easeVarying:Ba,end:ul,[Symbol.iterator]:Xt[Symbol.iterator]};function hl(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var dl={time:null,delay:0,duration:250,ease:hl};function gl(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function pl(t){var e,n;t instanceof Yt?(e=t._id,t=t._name):(e=fo(),(n=dl).time=Pn(),t=t==null?null:t+"");for(var r=this._groups,o=r.length,i=0;i<o;++i)for(var s=r[i],l=s.length,a,c=0;c<l;++c)(a=s[c])&&$e(a,t,e,c,s,n||gl(a,e));return new Yt(r,this._parents,t,e)}ye.prototype.interrupt=ha;ye.prototype.transition=pl;const Ie=t=>()=>t;function ml(t,{sourceEvent:e,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function Dt(t,e,n){this.k=t,this.x=e,this.y=n}Dt.prototype={constructor:Dt,scale:function(t){return t===1?this:new Dt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Dt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var tn=new Dt(1,0,0);ho.prototype=Dt.prototype;function ho(t){for(;!t.__zoom;)if(!(t=t.parentNode))return tn;return t.__zoom}function sn(t){t.stopImmediatePropagation()}function ce(t){t.preventDefault(),t.stopImmediatePropagation()}function _l(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function vl(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function or(){return this.__zoom||tn}function yl(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function wl(){return navigator.maxTouchPoints||"ontouchstart"in this}function bl(t,e,n){var r=t.invertX(e[0][0])-n[0][0],o=t.invertX(e[1][0])-n[1][0],i=t.invertY(e[0][1])-n[0][1],s=t.invertY(e[1][1])-n[1][1];return t.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function kl(){var t=_l,e=vl,n=bl,r=yl,o=wl,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,a=oa,c=xn("start","zoom","end"),u,f,g,m=500,_=150,x=0,w=10;function b(y){y.property("__zoom",or).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",z).filter(o).on("touchstart.zoom",j).on("touchmove.zoom",Y).on("touchend.zoom touchcancel.zoom",nt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(y,C,T,L){var O=y.selection?y.selection():y;O.property("__zoom",or),y!==O?d(y,C,T,L):O.interrupt().each(function(){h(this,arguments).event(L).start().zoom(null,typeof C=="function"?C.apply(this,arguments):C).end()})},b.scaleBy=function(y,C,T,L){b.scaleTo(y,function(){var O=this.__zoom.k,B=typeof C=="function"?C.apply(this,arguments):C;return O*B},T,L)},b.scaleTo=function(y,C,T,L){b.transform(y,function(){var O=e.apply(this,arguments),B=this.__zoom,X=T==null?N(O):typeof T=="function"?T.apply(this,arguments):T,F=B.invert(X),D=typeof C=="function"?C.apply(this,arguments):C;return n(A(S(B,D),X,F),O,s)},T,L)},b.translateBy=function(y,C,T,L){b.transform(y,function(){return n(this.__zoom.translate(typeof C=="function"?C.apply(this,arguments):C,typeof T=="function"?T.apply(this,arguments):T),e.apply(this,arguments),s)},null,L)},b.translateTo=function(y,C,T,L,O){b.transform(y,function(){var B=e.apply(this,arguments),X=this.__zoom,F=L==null?N(B):typeof L=="function"?L.apply(this,arguments):L;return n(tn.translate(F[0],F[1]).scale(X.k).translate(typeof C=="function"?-C.apply(this,arguments):-C,typeof T=="function"?-T.apply(this,arguments):-T),B,s)},L,O)};function S(y,C){return C=Math.max(i[0],Math.min(i[1],C)),C===y.k?y:new Dt(C,y.x,y.y)}function A(y,C,T){var L=C[0]-T[0]*y.k,O=C[1]-T[1]*y.k;return L===y.x&&O===y.y?y:new Dt(y.k,L,O)}function N(y){return[(+y[0][0]+ +y[1][0])/2,(+y[0][1]+ +y[1][1])/2]}function d(y,C,T,L){y.on("start.zoom",function(){h(this,arguments).event(L).start()}).on("interrupt.zoom end.zoom",function(){h(this,arguments).event(L).end()}).tween("zoom",function(){var O=this,B=arguments,X=h(O,B).event(L),F=e.apply(O,B),D=T==null?N(F):typeof T=="function"?T.apply(O,B):T,tt=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),W=O.__zoom,H=typeof C=="function"?C.apply(O,B):C,Et=a(W.invert(D).concat(tt/W.k),H.invert(D).concat(tt/H.k));return function(v){if(v===1)v=H;else{var R=Et(v),P=tt/R[2];v=new Dt(P,D[0]-R[0]*P,D[1]-R[1]*P)}X.zoom(null,v)}})}function h(y,C,T){return!T&&y.__zooming||new E(y,C)}function E(y,C){this.that=y,this.args=C,this.active=0,this.sourceEvent=null,this.extent=e.apply(y,C),this.taps=0}E.prototype={event:function(y){return y&&(this.sourceEvent=y),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(y,C){return this.mouse&&y!=="mouse"&&(this.mouse[1]=C.invert(this.mouse[0])),this.touch0&&y!=="touch"&&(this.touch0[1]=C.invert(this.touch0[0])),this.touch1&&y!=="touch"&&(this.touch1[1]=C.invert(this.touch1[0])),this.that.__zoom=C,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(y){var C=qt(this.that).datum();c.call(y,this.that,new ml(y,{sourceEvent:this.sourceEvent,target:b,type:y,transform:this.that.__zoom,dispatch:c}),C)}};function I(y,...C){if(!t.apply(this,arguments))return;var T=h(this,C).event(y),L=this.__zoom,O=Math.max(i[0],Math.min(i[1],L.k*Math.pow(2,r.apply(this,arguments)))),B=Ft(y);if(T.wheel)(T.mouse[0][0]!==B[0]||T.mouse[0][1]!==B[1])&&(T.mouse[1]=L.invert(T.mouse[0]=B)),clearTimeout(T.wheel);else{if(L.k===O)return;T.mouse=[B,L.invert(B)],Be(this),T.start()}ce(y),T.wheel=setTimeout(X,_),T.zoom("mouse",n(A(S(L,O),T.mouse[0],T.mouse[1]),T.extent,s));function X(){T.wheel=null,T.end()}}function k(y,...C){if(g||!t.apply(this,arguments))return;var T=y.currentTarget,L=h(this,C,!0).event(y),O=qt(y.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",tt,!0),B=Ft(y,T),X=y.clientX,F=y.clientY;Cs(y.view),sn(y),L.mouse=[B,this.__zoom.invert(B)],Be(this),L.start();function D(W){if(ce(W),!L.moved){var H=W.clientX-X,Et=W.clientY-F;L.moved=H*H+Et*Et>x}L.event(W).zoom("mouse",n(A(L.that.__zoom,L.mouse[0]=Ft(W,T),L.mouse[1]),L.extent,s))}function tt(W){O.on("mousemove.zoom mouseup.zoom",null),Ms(W.view,L.moved),ce(W),L.event(W).end()}}function z(y,...C){if(t.apply(this,arguments)){var T=this.__zoom,L=Ft(y.changedTouches?y.changedTouches[0]:y,this),O=T.invert(L),B=T.k*(y.shiftKey?.5:2),X=n(A(S(T,B),L,O),e.apply(this,C),s);ce(y),l>0?qt(this).transition().duration(l).call(d,X,L,y):qt(this).call(b.transform,X,L,y)}}function j(y,...C){if(t.apply(this,arguments)){var T=y.touches,L=T.length,O=h(this,C,y.changedTouches.length===L).event(y),B,X,F,D;for(sn(y),X=0;X<L;++X)F=T[X],D=Ft(F,this),D=[D,this.__zoom.invert(D),F.identifier],O.touch0?!O.touch1&&O.touch0[2]!==D[2]&&(O.touch1=D,O.taps=0):(O.touch0=D,B=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),B&&(O.taps<2&&(f=D[0],u=setTimeout(function(){u=null},m)),Be(this),O.start())}}function Y(y,...C){if(this.__zooming){var T=h(this,C).event(y),L=y.changedTouches,O=L.length,B,X,F,D;for(ce(y),B=0;B<O;++B)X=L[B],F=Ft(X,this),T.touch0&&T.touch0[2]===X.identifier?T.touch0[0]=F:T.touch1&&T.touch1[2]===X.identifier&&(T.touch1[0]=F);if(X=T.that.__zoom,T.touch1){var tt=T.touch0[0],W=T.touch0[1],H=T.touch1[0],Et=T.touch1[1],v=(v=H[0]-tt[0])*v+(v=H[1]-tt[1])*v,R=(R=Et[0]-W[0])*R+(R=Et[1]-W[1])*R;X=S(X,Math.sqrt(v/R)),F=[(tt[0]+H[0])/2,(tt[1]+H[1])/2],D=[(W[0]+Et[0])/2,(W[1]+Et[1])/2]}else if(T.touch0)F=T.touch0[0],D=T.touch0[1];else return;T.zoom("touch",n(A(X,F,D),T.extent,s))}}function nt(y,...C){if(this.__zooming){var T=h(this,C).event(y),L=y.changedTouches,O=L.length,B,X;for(sn(y),g&&clearTimeout(g),g=setTimeout(function(){g=null},m),B=0;B<O;++B)X=L[B],T.touch0&&T.touch0[2]===X.identifier?delete T.touch0:T.touch1&&T.touch1[2]===X.identifier&&delete T.touch1;if(T.touch1&&!T.touch0&&(T.touch0=T.touch1,delete T.touch1),T.touch0)T.touch0[1]=this.__zoom.invert(T.touch0[0]);else if(T.end(),T.taps===2&&(X=Ft(X,this),Math.hypot(f[0]-X[0],f[1]-X[1])<w)){var F=qt(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return b.wheelDelta=function(y){return arguments.length?(r=typeof y=="function"?y:Ie(+y),b):r},b.filter=function(y){return arguments.length?(t=typeof y=="function"?y:Ie(!!y),b):t},b.touchable=function(y){return arguments.length?(o=typeof y=="function"?y:Ie(!!y),b):o},b.extent=function(y){return arguments.length?(e=typeof y=="function"?y:Ie([[+y[0][0],+y[0][1]],[+y[1][0],+y[1][1]]]),b):e},b.scaleExtent=function(y){return arguments.length?(i[0]=+y[0],i[1]=+y[1],b):[i[0],i[1]]},b.translateExtent=function(y){return arguments.length?(s[0][0]=+y[0][0],s[1][0]=+y[1][0],s[0][1]=+y[0][1],s[1][1]=+y[1][1],b):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},b.constrain=function(y){return arguments.length?(n=y,b):n},b.duration=function(y){return arguments.length?(l=+y,b):l},b.interpolate=function(y){return arguments.length?(a=y,b):a},b.on=function(){var y=c.on.apply(c,arguments);return y===c?b:y},b.clickDistance=function(y){return arguments.length?(x=(y=+y)*y,b):Math.sqrt(x)},b.tapDistance=function(y){return arguments.length?(w=+y,b):w},b}function El(t,e,n,r,o,i,s){return t.select(`.Edges-${e}`).transition().duration(0).call(n.translateTo,0,0).transition().duration(0).call(n.translateTo,o.x,o.y).transition().duration(0).call(n.scaleBy,(.4+.16*i).toFixed(2)),r=t.zoomIdentity.translate(o.x,o.y).scale((.4+.16*i).toFixed(2)),t.select(`.Nodes-${e}`).transition().duration(0).call(n.translateTo,0,0).transition().duration(0).call(n.translateTo,o.x,o.y).transition().duration(0).call(n.scaleBy,(.4+.16*i).toFixed(2)),s.set(t.zoomTransform(t.select(`.Nodes-${e}`)).k),r}function xl(t,e,n){return t.zoom().filter(r=>!st(e)).scaleExtent([.2,10]).on("zoom",n)}function Sl(t){let e,n,r,o,i,s,l,a;return{c(){e=Q("g"),n=Q("rect"),s=Q("text"),l=jt(t[0]),this.h()},l(c){e=Z(c,"g",{});var u=V(e);n=Z(u,"rect",{class:!0,"data-testid":!0,fill:!0,x:!0,y:!0,width:!0,height:!0}),V(n).forEach(M),s=Z(u,"text",{class:!0,x:!0,y:!0,"font-size":!0,"dominant-baseline":!0,"text-anchor":!0,fill:!0});var f=V(s);l=Ut(f,t[0]),f.forEach(M),u.forEach(M),this.h()},h(){p(n,"class","EdgeTextBg"),p(n,"data-testid","edge-text-bg"),p(n,"fill",r=t[5]?t[5]:"white"),p(n,"x",o=t[3]-t[1]/2),p(n,"y",i=t[2]-ir),p(n,"width",t[1]),p(n,"height",16),p(s,"class","EdgeText"),p(s,"x",t[3]),p(s,"y",t[2]),p(s,"font-size","12px"),p(s,"dominant-baseline","central"),p(s,"text-anchor","middle"),p(s,"fill",a=t[4]?t[4]:"black")},m(c,u){U(c,e,u),G(e,n),G(e,s),G(s,l)},p(c,u){u&32&&r!==(r=c[5]?c[5]:"white")&&p(n,"fill",r),u&10&&o!==(o=c[3]-c[1]/2)&&p(n,"x",o),u&4&&i!==(i=c[2]-ir)&&p(n,"y",i),u&2&&p(n,"width",c[1]),u&1&&Ke(l,c[0]),u&8&&p(s,"x",c[3]),u&4&&p(s,"y",c[2]),u&16&&a!==(a=c[4]?c[4]:"black")&&p(s,"fill",a)},d(c){c&&M(e)}}}function Il(t){let e=null+"",n;return{c(){n=jt(e)},l(r){n=Ut(r,e)},m(r,o){U(r,n,o)},p:ct,d(r){r&&M(n)}}}function Nl(t){let e;function n(i,s){return typeof i[0]>"u"||!i[0]?Il:Sl}let r=n(t),o=r(t);return{c(){o.c(),e=Tt()},l(i){o.l(i),e=Tt()},m(i,s){o.m(i,s),U(i,e,s)},p(i,[s]){r===(r=n(i))&&o?o.p(i,s):(o.d(1),o=r(i),o&&(o.c(),o.m(e.parentNode,e)))},i:ct,o:ct,d(i){o.d(i),i&&M(e)}}}const ir=7;function Tl(t,e,n){let r,o,i,s,l,a,c,u,f,g,m,{edgeTextProps:_}=e;return t.$$set=x=>{"edgeTextProps"in x&&n(6,_=x.edgeTextProps)},t.$$.update=()=>{t.$$.dirty&64&&n(0,{label:r,labelBgColor:o,labelTextColor:i,centerX:s,centerY:l}=_,r,(n(5,o),n(6,_)),(n(4,i),n(6,_)),(n(11,s),n(6,_)),(n(10,l),n(6,_))),t.$$.dirty&1&&n(7,a=r.length<3?9:7),t.$$.dirty&2048&&n(3,c=s),t.$$.dirty&1024&&n(2,u=l),t.$$.dirty&1&&n(9,f=r.split(" ").length-1),t.$$.dirty&513&&n(8,g=r.length-f),t.$$.dirty&384&&n(1,m=g*a)},[r,m,u,c,i,o,_,a,g,f,l,s]}class Pl extends dt{constructor(e){super(),gt(this,e,Tl,Nl,pt,{edgeTextProps:6})}}function Al(t){let e,n,r;return{c(){e=Q("path"),this.h()},l(o){e=Z(o,"path",{class:!0,d:!0,fill:!0,stroke:!0,"aria-label":!0}),V(e).forEach(M),this.h()},h(){p(e,"class",n=Nt(t[3]?`animate ${t[7].className}`:`${t[7].className}`)+" svelte-7tz672"),p(e,"d",t[4]),p(e,"fill","transparent"),p(e,"stroke",r=t[1]!=="default"?t[1]:t[5]==="dark"?"white":"black"),p(e,"aria-label","svg-path")},m(o,i){U(o,e,i)},p(o,i){i&8&&n!==(n=Nt(o[3]?`animate ${o[7].className}`:`${o[7].className}`)+" svelte-7tz672")&&p(e,"class",n),i&16&&p(e,"d",o[4]),i&34&&r!==(r=o[1]!=="default"?o[1]:o[5]==="dark"?"white":"black")&&p(e,"stroke",r)},d(o){o&&M(e)}}}function Cl(t){let e,n,r;return{c(){e=Q("path"),this.h()},l(o){e=Z(o,"path",{class:!0,d:!0,fill:!0,stroke:!0,"marker-end":!0,"aria-label":!0}),V(e).forEach(M),this.h()},h(){p(e,"class",n=Nt(t[3]?`animate ${t[7].className}`:`${t[7].className}`)+" svelte-7tz672"),p(e,"d",t[4]),p(e,"fill","transparent"),p(e,"stroke",r=t[1]!=="default"?t[1]:t[5]==="dark"?"white":"black"),p(e,"marker-end","url(#arrow)"),p(e,"aria-label","svg-path")},m(o,i){U(o,e,i)},p(o,i){i&8&&n!==(n=Nt(o[3]?`animate ${o[7].className}`:`${o[7].className}`)+" svelte-7tz672")&&p(e,"class",n),i&16&&p(e,"d",o[4]),i&34&&r!==(r=o[1]!=="default"?o[1]:o[5]==="dark"?"white":"black")&&p(e,"stroke",r)},d(o){o&&M(e)}}}function sr(t){let e,n;return e=new Pl({props:{edgeTextProps:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o&1&&(i.edgeTextProps=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Ml(t){let e,n,r,o,i,s,l,a,c,u,f;function g(w,b){return w[2]?Cl:Al}let m=g(t),_=m(t),x=t[0].label&&sr(t);return{c(){e=Q("defs"),n=Q("marker"),r=Q("polygon"),o=xt(),i=Q("path"),s=xt(),_.c(),l=xt(),x&&x.c(),a=Tt(),this.h()},l(w){e=Z(w,"defs",{});var b=V(e);n=Z(b,"marker",{id:!0,markerWidth:!0,markerHeight:!0,refX:!0,refY:!0,orient:!0});var S=V(n);r=Z(S,"polygon",{points:!0,fill:!0}),V(r).forEach(M),S.forEach(M),b.forEach(M),o=St(w),i=Z(w,"path",{id:!0,d:!0,fill:!0,stroke:!0,"stroke-opacity":!0,"stroke-width":!0,class:!0}),V(i).forEach(M),s=St(w),_.l(w),l=St(w),x&&x.l(w),a=Tt(),this.h()},h(){p(r,"points",t[9]),p(r,"fill","gray"),p(n,"id","arrow"),p(n,"markerWidth","9"),p(n,"markerHeight","9"),p(n,"refX","8"),p(n,"refY","4"),p(n,"orient","auto"),p(i,"id","edgeSelector"),p(i,"d",t[4]),p(i,"fill","transparent"),p(i,"stroke","red"),p(i,"stroke-opacity","0"),p(i,"stroke-width","20"),p(i,"class","svelte-7tz672")},m(w,b){U(w,e,b),G(e,n),G(n,r),U(w,o,b),U(w,i,b),U(w,s,b),_.m(w,b),U(w,l,b),x&&x.m(w,b),U(w,a,b),c=!0,u||(f=[et(i,"click",t[8]),et(i,"keypress",t[17])],u=!0)},p(w,[b]){(!c||b&16)&&p(i,"d",w[4]),m===(m=g(w))&&_?_.p(w,b):(_.d(1),_=m(w),_&&(_.c(),_.m(l.parentNode,l))),w[0].label?x?(x.p(w,b),b&1&&q(x,1)):(x=sr(w),x.c(),q(x,1),x.m(a.parentNode,a)):x&&(Lt(),K(x,1,1,()=>{x=null}),Rt())},i(w){c||(q(x),c=!0)},o(w){K(x),c=!1},d(w){w&&M(e),w&&M(o),w&&M(i),w&&M(s),_.d(w),w&&M(l),x&&x.d(w),w&&M(a),u=!1,se(f)}}}function Ol(t,e,n){let r,o,i,s,l,a,c,u,f,g,m,{baseEdgeProps:_}=e,{canvasId:x}=e;const w=_.id,b=At(x),S=b.themeStore;it(t,S,E=>n(5,m=E));const A=De(b,w),N=()=>{const E=At(x),I=De(E,w);I.clickCallback&&I.clickCallback(I),console.log(I.className)},d="0 0, 9 4.5, 0 9";function h(E){ln.call(this,t,E)}return t.$$set=E=>{"baseEdgeProps"in E&&n(10,_=E.baseEdgeProps),"canvasId"in E&&n(11,x=E.canvasId)},t.$$.update=()=>{t.$$.dirty&1024&&n(4,{path:r,animate:o,arrow:i,label:s,labelBgColor:l,labelTextColor:a,edgeColor:c,centerX:u,centerY:f}=_,r,(n(3,o),n(10,_)),(n(2,i),n(10,_)),(n(16,s),n(10,_)),(n(15,l),n(10,_)),(n(14,a),n(10,_)),(n(1,c),n(10,_)),(n(13,u),n(10,_)),(n(12,f),n(10,_))),t.$$.dirty&126976&&n(0,g={label:s,labelBgColor:l,labelTextColor:a,centerX:u,centerY:f})},[g,c,i,o,r,m,S,A,N,d,_,x,f,u,a,l,s,h]}class Mn extends dt{constructor(e){super(),gt(this,e,Ol,Ml,pt,{baseEdgeProps:10,canvasId:11})}}function Ll(t){let e,n;return e=new Mn({props:{baseEdgeProps:t[1],canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,[o]){const i={};o&2&&(i.baseEdgeProps=r[1]),o&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Ne(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Rl(t,e,n){let r,o,i,s,l;const a={};a.Left="left",a.Right="right",a.Top="top",a.Bottom="bottom";function c({pos:N,x1:d,y1:h,x2:E,y2:I,c:k}){let z,j;switch(N){case a.Left:z=d-Ne(d-E,k),j=h;break;case a.Right:z=d+Ne(E-d,k),j=h;break;case a.Top:z=d,j=h-Ne(h-I,k);break;case a.Bottom:z=d,j=h+Ne(I-h,k);break}return[z,j]}function u({sourceX:N,sourceY:d,sourcePosition:h=a.Bottom,targetX:E,targetY:I,targetPosition:k=a.Top,curvature:z=.25}){const[j,Y]=c({pos:h,x1:N,y1:d,x2:E,y2:I,c:z}),[nt,y]=c({pos:k,x1:E,y1:I,x2:N,y2:d,c:z});return`M${N},${d} C${j},${Y} ${nt},${y} ${E},${I}`}function f({sourceX:N,sourceY:d,sourcePosition:h=a.Bottom,targetX:E,targetY:I,targetPosition:k=a.Top,curvature:z=.25}){const[j,Y]=c({pos:h,x1:N,y1:d,x2:E,y2:I,c:z}),[nt,y]=c({pos:k,x1:E,y1:I,x2:N,y2:d,c:z}),C=N*.125+j*.375+nt*.375+E*.125,T=d*.125+Y*.375+y*.375+I*.125,L=Math.abs(C-N),O=Math.abs(T-d);return[C,T,L,O]}let{canvasId:g}=e,{edgeId:m}=e;const _=At(g),{nodesStore:x,edgesStore:w,anchorsStore:b}=_;it(t,w,N=>n(9,l=N));let S,A;return t.$$set=N=>{"canvasId"in N&&n(0,g=N.canvasId),"edgeId"in N&&n(3,m=N.edgeId)},t.$$.update=()=>{if(t.$$.dirty&520&&n(4,S=l[m]),t.$$.dirty&17){const N=At(g),d=re(N,S.id,"source"),h=re(N,S.id,"target"),E={0:"right",90:"top",180:"left",270:"bottom"};n(5,A={sourceX:S.sourceX,sourceY:S.sourceY,sourcePosition:E[d.angle],targetX:S.targetX,targetY:S.targetY,targetPosition:E[h.angle],curvature:.25})}t.$$.dirty&32&&n(8,r=u(A)),t.$$.dirty&32&&n(7,[o,i]=f(A),o,(n(6,i),n(5,A),n(0,g),n(4,S),n(9,l),n(3,m))),t.$$.dirty&464&&n(1,s={...S,path:r,centerX:o,centerY:i})},[g,s,w,m,S,A,i,o,r,l]}class zl extends dt{constructor(e){super(),gt(this,e,Rl,Ll,pt,{canvasId:0,edgeId:3})}}const ar=["left","right"],lr=({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:o="bottom",targetPosition:i="top"})=>{const s=ar.includes(o),l=ar.includes(i);if(s&&!l||l&&!s){const m=s?Math.abs(n-t):0,_=t>n?t-m:t+m,x=s?0:Math.abs(r-e),w=e<r?e+x:e-x;return[_,w,m,x]}const c=Math.abs(n-t)/2,u=n<t?n+c:n-c,f=Math.abs(r-e)/2,g=r<e?r+f:r-f;return[u,g,c,f]};function Bl(t){let e,n;return e=new Mn({props:{baseEdgeProps:t[1],canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,[o]){const i={};o&2&&(i.baseEdgeProps=r[1]),o&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Xl(t,e,n){let r,o,i,s;const l={};l.Left="left",l.Right="right",l.Top="top",l.Bottom="bottom";const a=(d,h,E)=>`L ${d},${h-E}Q ${d},${h} ${d+E},${h}`,c=(d,h,E)=>`L ${d+E},${h}Q ${d},${h} ${d},${h-E}`,u=(d,h,E)=>`L ${d},${h-E}Q ${d},${h} ${d-E},${h}`,f=(d,h,E)=>`L ${d-E},${h}Q ${d},${h} ${d},${h-E}`,g=(d,h,E)=>`L ${d+E},${h}Q ${d},${h} ${d},${h+E}`,m=(d,h,E)=>`L ${d},${h+E}Q ${d},${h} ${d+E},${h}`,_=(d,h,E)=>`L ${d},${h+E}Q ${d},${h} ${d-E},${h}`,x=(d,h,E)=>`L ${d-E},${h}Q ${d},${h} ${d},${h+E}`;function w({sourceX:d,sourceY:h,sourcePosition:E=l.Bottom,targetX:I,targetY:k,targetPosition:z=l.Top,borderRadius:j=5,centerX:Y,centerY:nt}){const[y,C,T,L]=lr({sourceX:d,sourceY:h,targetX:I,targetY:k}),O=Math.min(j,Math.abs(I-d)),B=Math.min(j,Math.abs(k-h)),X=Math.min(O,B,T,L),F=[l.Left,l.Right],D=typeof Y<"u"?Y:y,tt=typeof nt<"u"?nt:C;let W=null,H=null;return d<=I?(W=h<=k?a(d,tt,X):m(d,tt,X),H=h<=k?x(I,tt,X):f(I,tt,X)):(W=h<k?u(d,tt,X):_(d,tt,X),H=h<k?g(I,tt,X):c(I,tt,X)),F.includes(E)&&F.includes(z)?d<=I?(W=h<=k?x(D,h,X):f(D,h,X),H=h<=k?a(D,k,X):m(D,k,X)):(E===l.Right&&z===l.Left||E===l.Left&&z===l.Right||E===l.Left&&z===l.Left)&&(W=h<=k?g(D,h,X):c(D,h,X),H=h<=k?u(D,k,X):_(D,k,X)):F.includes(E)&&!F.includes(z)?(d<=I?W=h<=k?x(I,h,X):f(I,h,X):W=h<=k?g(I,h,X):c(I,h,X),H=""):!F.includes(E)&&F.includes(z)&&(d<=I?W=h<=k?a(d,k,X):m(d,k,X):W=h<=k?u(d,k,X):_(d,k,X),H=""),`M ${d},${h}${W}${H}L ${I},${k}`}let{edge:b}=e,{borderRadius:S=5}=e,{canvasId:A}=e,N;return t.$$set=d=>{"edge"in d&&n(3,b=d.edge),"borderRadius"in d&&n(4,S=d.borderRadius),"canvasId"in d&&n(0,A=d.canvasId)},t.$$.update=()=>{if(t.$$.dirty&25){const d=At(A),h=re(d,b.id,"source"),E=re(d,b.id,"target"),I={0:"right",90:"top",180:"left",270:"bottom"};n(5,N={sourceX:b.sourceX,sourceY:b.sourceY,targetX:b.targetX,targetY:b.targetY,sourcePosition:I[h.angle],targetPosition:I[E.angle],borderRadius:S})}t.$$.dirty&32&&n(7,[r,o]=lr(N),r,(n(6,o),n(5,N),n(0,A),n(3,b),n(4,S))),t.$$.dirty&32&&n(8,i=w(N)),t.$$.dirty&456&&n(1,s={...b,path:i,centerX:r,centerY:o})},[A,s,w,b,S,N,o,r,i]}class go extends dt{constructor(e){super(),gt(this,e,Xl,Bl,pt,{getSmoothStepPath:2,edge:3,borderRadius:4,canvasId:0})}get getSmoothStepPath(){return this.$$.ctx[2]}}function Dl(t){let e,n;return e=new go({props:{edge:t[0],borderRadius:0,canvasId:t[1]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,[o]){const i={};o&1&&(i.edge=r[0]),o&2&&(i.canvasId=r[1]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Yl(t,e,n){let{edge:r}=e,{canvasId:o}=e;return t.$$set=i=>{"edge"in i&&n(0,r=i.edge),"canvasId"in i&&n(1,o=i.canvasId)},[r,o]}class Fl extends dt{constructor(e){super(),gt(this,e,Yl,Dl,pt,{edge:0,canvasId:1})}}function Vl(t){let e,n;return e=new Mn({props:{baseEdgeProps:t[1],canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,[o]){const i={};o&2&&(i.baseEdgeProps=r[1]),o&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Hl(t,e,n){let r,o,i,s,l,a,c,u,{edgeId:f}=e,{canvasId:g}=e;const m=At(g),{nodesStore:_,edgesStore:x,anchorsStore:w}=m;return it(t,x,b=>n(10,u=b)),t.$$set=b=>{"edgeId"in b&&n(3,f=b.edgeId),"canvasId"in b&&n(0,g=b.canvasId)},t.$$.update=()=>{t.$$.dirty&1032&&n(7,r=u[f]),t.$$.dirty&128&&n(6,o=`M ${r.sourceX},${r.sourceY}L ${r.targetX},${r.targetY}`),t.$$.dirty&128&&n(9,i=Math.abs(r.targetX-r.sourceX)/2),t.$$.dirty&128&&n(8,s=Math.abs(r.targetY-r.sourceY)/2),t.$$.dirty&640&&n(5,l=r.targetX<r.sourceX?r.targetX+i:r.targetX-i),t.$$.dirty&384&&n(4,a=r.targetY<r.sourceY?r.targetY+s:r.targetY-s),t.$$.dirty&240&&n(1,c={...r,path:o,centerX:l,centerY:a})},[g,c,x,f,a,l,o,r,s,i,u]}class ql extends dt{constructor(e){super(),gt(this,e,Hl,Vl,pt,{edgeId:3,canvasId:0})}}function Gl(t){let e;return{c(){e=Q("circle"),this.h()},l(n){e=Z(n,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,fill:!0,class:!0}),V(e).forEach(M),this.h()},h(){p(e,"cx",t[0]),p(e,"cy",t[1]),p(e,"r",5),p(e,"stroke","white"),p(e,"fill","black"),p(e,"class","svelte-1ulqurc")},m(n,r){U(n,e,r)},p(n,[r]){r&1&&p(e,"cx",n[0]),r&2&&p(e,"cy",n[1])},i:ct,o:ct,d(n){n&&M(e)}}}function jl(t,e,n){let{x:r}=e,{y:o}=e;return t.$$set=i=>{"x"in i&&n(0,r=i.x),"y"in i&&n(1,o=i.y)},[r,o]}class Ul extends dt{constructor(e){super(),gt(this,e,jl,Gl,pt,{x:0,y:1})}}function cr(t,e,n){const r=t.slice();return r[19]=e[n],r[21]=n,r}function ur(t,e,n){const r=t.slice();return r[22]=e[n],r[21]=n,r}function fr(t){let e,n=t[0].label+"",r;return{c(){e=at("div"),r=jt(n),this.h()},l(o){e=lt(o,"DIV",{class:!0});var i=V(e);r=Ut(i,n),i.forEach(M),this.h()},h(){p(e,"class","label svelte-1ymbpbh")},m(o,i){U(o,e,i),G(e,r)},p(o,i){i&1&&n!==(n=o[0].label+"")&&Ke(r,n)},d(o){o&&M(e)}}}function hr(t){let e,n,r,o=t[22]+"",i,s;return{c(){e=Q("circle"),r=Q("text"),i=jt(o),this.h()},l(l){e=Z(l,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,fill:!0}),V(e).forEach(M),r=Z(l,"text",{class:!0,x:!0,y:!0});var a=V(r);i=Ut(a,o),a.forEach(M),this.h()},h(){p(e,"cx",6.5),p(e,"cy",n=t[0].height/2+t[21]*yt-(t[0].inPorts.length-1)/2*yt),p(e,"r",3),p(e,"stroke","#444444"),p(e,"fill","white"),p(r,"class","port-annotation svelte-1ymbpbh"),p(r,"x","12.5"),p(r,"y",s=t[0].height/2+t[21]*yt-(t[0].inPorts.length-1)/2*yt+1.25),vt(r,"visible",t[1]>2)},m(l,a){U(l,e,a),U(l,r,a),G(r,i)},p(l,a){a&1&&n!==(n=l[0].height/2+l[21]*yt-(l[0].inPorts.length-1)/2*yt)&&p(e,"cy",n),a&1&&o!==(o=l[22]+"")&&Ke(i,o),a&1&&s!==(s=l[0].height/2+l[21]*yt-(l[0].inPorts.length-1)/2*yt+1.25)&&p(r,"y",s),a&2&&vt(r,"visible",l[1]>2)},d(l){l&&M(e),l&&M(r)}}}function dr(t){let e,n,r,o,i=t[19]+"",s,l,a;return{c(){e=Q("circle"),o=Q("text"),s=jt(i),this.h()},l(c){e=Z(c,"circle",{cx:!0,cy:!0,r:!0,stroke:!0,fill:!0}),V(e).forEach(M),o=Z(c,"text",{class:!0,"text-anchor":!0,x:!0,y:!0});var u=V(o);s=Ut(u,i),u.forEach(M),this.h()},h(){p(e,"cx",n=t[0].width+13.5),p(e,"cy",r=t[0].height/2+t[21]*yt-(t[0].outPorts.length-1)/2*yt),p(e,"r",3),p(e,"stroke","#444444"),p(e,"fill","white"),p(o,"class","port-annotation svelte-1ymbpbh"),p(o,"text-anchor","end"),p(o,"x",l=t[0].width+7.5),p(o,"y",a=t[0].height/2+t[21]*yt-(t[0].outPorts.length-1)/2*yt+1.25),vt(o,"visible",t[1]>2)},m(c,u){U(c,e,u),U(c,o,u),G(o,s)},p(c,u){u&1&&n!==(n=c[0].width+13.5)&&p(e,"cx",n),u&1&&r!==(r=c[0].height/2+c[21]*yt-(c[0].outPorts.length-1)/2*yt)&&p(e,"cy",r),u&1&&i!==(i=c[19]+"")&&Ke(s,i),u&1&&l!==(l=c[0].width+7.5)&&p(o,"x",l),u&1&&a!==(a=c[0].height/2+c[21]*yt-(c[0].outPorts.length-1)/2*yt+1.25)&&p(o,"y",a),u&2&&vt(o,"visible",c[1]>2)},d(c){c&&M(e),c&&M(o)}}}function Wl(t){let e,n,r,o,i,s,l,a,c,u,f,g,m;var _=t[0].icon;function x(d){return{props:{color:d[0].bgColor!=="default"?gr(d[0].bgColor,-30):"#c8ced0",height:"45px"}}}_&&(o=Rn(_,x(t)));let w=t[0].label!==""&&fr(t),b=t[0].inPorts,S=[];for(let d=0;d<b.length;d+=1)S[d]=hr(ur(t,b,d));let A=t[0].outPorts,N=[];for(let d=0;d<A.length;d+=1)N[d]=dr(cr(t,A,d));return{c(){e=at("div"),n=at("div"),r=at("div"),o&&ut(o.$$.fragment),s=xt(),w&&w.c(),l=xt(),a=Q("svg");for(let d=0;d<S.length;d+=1)S[d].c();c=Tt();for(let d=0;d<N.length;d+=1)N[d].c();this.h()},l(d){e=lt(d,"DIV",{class:!0,style:!0,id:!0});var h=V(e);n=lt(h,"DIV",{class:!0});var E=V(n);r=lt(E,"DIV",{class:!0,style:!0});var I=V(r);o&&mt(o.$$.fragment,I),I.forEach(M),E.forEach(M),s=St(h),w&&w.l(h),l=St(h),a=Z(h,"svg",{class:!0});var k=V(a);for(let z=0;z<S.length;z+=1)S[z].l(k);c=Tt();for(let z=0;z<N.length;z+=1)N[z].l(k);k.forEach(M),h.forEach(M),this.h()},h(){p(r,"class","icon svelte-1ymbpbh"),p(r,"style",i=t[0].bgColor!=="default"?`background-color: ${t[0].bgColor}`:""),p(n,"class","ring svelte-1ymbpbh"),p(a,"class","ports svelte-1ymbpbh"),p(e,"class","node svelte-1ymbpbh"),J(e,"left",t[0].positionX+"px"),J(e,"top",t[0].positionY+"px"),J(e,"height",t[0].height+"px"),J(e,"width",t[0].width+"px"),p(e,"id",u="svelvet-"+t[0].id)},m(d,h){U(d,e,h),G(e,n),G(n,r),o&&ft(o,r,null),G(e,s),w&&w.m(e,null),G(e,l),G(e,a);for(let E=0;E<S.length;E+=1)S[E].m(a,null);G(a,c);for(let E=0;E<N.length;E+=1)N[E].m(a,null);f=!0,g||(m=[et(window,"mousemove",t[9]),et(window,"mouseup",t[11]),et(window,"touchmove",t[10]),et(window,"touchend",t[11]),et(e,"mouseleave",t[7]),et(e,"mousedown",t[5]),et(e,"contextmenu",t[6]),et(e,"touchstart",t[5]),et(e,"mouseenter",t[8])],g=!0)},p(d,[h]){const E={};if(h&1&&(E.color=d[0].bgColor!=="default"?gr(d[0].bgColor,-30):"#c8ced0"),_!==(_=d[0].icon)){if(o){Lt();const I=o;K(I.$$.fragment,1,0,()=>{ht(I,1)}),Rt()}_?(o=Rn(_,x(d)),ut(o.$$.fragment),q(o.$$.fragment,1),ft(o,r,null)):o=null}else _&&o.$set(E);if((!f||h&1&&i!==(i=d[0].bgColor!=="default"?`background-color: ${d[0].bgColor}`:""))&&p(r,"style",i),d[0].label!==""?w?w.p(d,h):(w=fr(d),w.c(),w.m(e,l)):w&&(w.d(1),w=null),h&3){b=d[0].inPorts;let I;for(I=0;I<b.length;I+=1){const k=ur(d,b,I);S[I]?S[I].p(k,h):(S[I]=hr(k),S[I].c(),S[I].m(a,c))}for(;I<S.length;I+=1)S[I].d(1);S.length=b.length}if(h&3){A=d[0].outPorts;let I;for(I=0;I<A.length;I+=1){const k=cr(d,A,I);N[I]?N[I].p(k,h):(N[I]=dr(k),N[I].c(),N[I].m(a,null))}for(;I<N.length;I+=1)N[I].d(1);N.length=A.length}(!f||h&1)&&J(e,"left",d[0].positionX+"px"),(!f||h&1)&&J(e,"top",d[0].positionY+"px"),(!f||h&1)&&J(e,"height",d[0].height+"px"),(!f||h&1)&&J(e,"width",d[0].width+"px"),(!f||h&1&&u!==(u="svelvet-"+d[0].id))&&p(e,"id",u)},i(d){f||(o&&q(o.$$.fragment,d),f=!0)},o(d){o&&K(o.$$.fragment,d),f=!1},d(d){d&&M(e),o&&ht(o),w&&w.d(),Ht(S,d),Ht(N,d),g=!1,se(m)}}}const yt=17.5;function gr(t,e){var n=parseInt(t.substring(1,3),16),r=parseInt(t.substring(3,5),16),o=parseInt(t.substring(5,7),16);n=parseInt(n*(100+e)/100),r=parseInt(r*(100+e)/100),o=parseInt(o*(100+e)/100),n=n<255?n:255,r=r<255?r:255,o=o<255?o:255,n=Math.round(n),r=Math.round(r),o=Math.round(o);var i=n.toString(16).length==1?"0"+n.toString(16):n.toString(16),s=r.toString(16).length==1?"0"+r.toString(16):r.toString(16),l=o.toString(16).length==1?"0"+o.toString(16):o.toString(16);return"#"+i+s+l}function Kl(t,e,n){let r,o,i,{node:s}=e,{canvasId:l}=e,{nodeId:a}=e;const c=At(l),{nodesStore:u,nodeSelected:f,d3Scale:g}=c;it(t,u,h=>n(17,o=h)),it(t,f,h=>n(16,r=h)),it(t,g,h=>n(1,i=h));let m=!1,_=!1;const x=h=>{h.preventDefault(),_=!0,nn(f,r=!0,r),m=!0},w=h=>{h.preventDefault(),n(0,s=o[a]),nn(f,r=!0,r),m=!1},b=h=>{_=!1,nn(f,r=!1,r)},S=h=>{f.set(!0)},A=h=>{h.preventDefault(),_=!1,m&&u.update(E=>{const I=E[a],k=st(c.d3Scale);return I.setPositionFromMovement(h.movementX/k,h.movementY/k),{...E}})},N=h=>{_=!1,m&&u.update(E=>{const I=E[a],{x:k,y:z,width:j,height:Y}=h.target.getBoundingClientRect(),nt=(h.touches[0].clientX-k)/j*h.target.offsetWidth,y=(h.touches[0].clientY-z)/Y*h.target.offsetHeight;return I.setPositionFromMovement(nt-I.width/2,y-I.height/2),{...E}})},d=h=>{if(h.preventDefault(),m=!1,s.clickCallback&&_&&s.clickCallback(s),st(c.options).snap){const E=st(c.options).snapTo,I=s.positionX,k=s.positionY,z=Math.round(s.positionX/E)*E,j=Math.round(s.positionY/E)*E;u.update(Y=>(Y[a].setPositionFromMovement(z-I,j-k),{...Y}))}};return t.$$set=h=>{"node"in h&&n(0,s=h.node),"canvasId"in h&&n(12,l=h.canvasId),"nodeId"in h&&n(13,a=h.nodeId)},[s,i,u,f,g,x,w,b,S,A,N,d,l,a]}class Ql extends dt{constructor(e){super(),gt(this,e,Kl,Wl,pt,{node:0,canvasId:12,nodeId:13})}}class po{constructor(e,n,r,o,i,s,l,a,c,u,f,g,m,_,x,w){this.id=e,this.sourceX=n,this.sourceY=r,this.targetX=o,this.targetY=i,this.canvasId=s,this.label=l,this.type=a,this.labelBgColor=c,this.labelTextColor=u,this.edgeColor=f,this.animate=g,this.noHandle=m,this.arrow=_,this.clickCallback=x,this.className=w}delete(){const e=It[this.canvasId],{nodesStore:n,anchorsStore:r,edgesStore:o}=e,i=re(e,this.id,"source"),s=re(e,this.id,"target");r.update(l=>{for(const a in l)(a===i.id||a==s.id)&&delete l[a];return{...l}}),o.update(l=>(delete l[this.id],{...l}))}}class je{constructor(e,n,r,o,i,s,l,a,c){this.id=e,this.nodeId=n,this.edgeId=r,this.sourceOrTarget=o,this.positionX=i,this.positionY=s,this.callback=l,this.canvasId=a,this.angle=c}getOtherAnchorId(){const e=It[this.canvasId],n=ae(e,{edgeId:this.edgeId});if(n.length!==2)throw"something is wrong, every anchor should have exactly one other associated anchor";return n.filter(o=>o.id!==this.id)[0].id}setPositionFromNode(){this.callback();const{edgesStore:e}=It[this.canvasId];e.update(n=>{const r=n[this.edgeId];return this.sourceOrTarget==="source"?(r.sourceX=this.positionX,r.sourceY=this.positionY):(r.targetX=this.positionX,r.targetY=this.positionY),{...n}})}updateEdges(){const{edgesStore:e}=It[this.canvasId];e.update(n=>{const r=n[this.edgeId];return r===void 0?{...n}:(this.sourceOrTarget==="source"?(r.sourceX=this.positionX,r.sourceY=this.positionY):(r.targetX=this.positionX,r.targetY=this.positionY),{...n})})}setPosition(e,n){this.positionX=e,this.positionY=n,this.updateEdges()}setPositionFromMovement(e,n){this.positionX+=e,this.positionY+=n;const{edgesStore:r}=It[this.canvasId];r.update(o=>{const i=o[this.edgeId];return this.sourceOrTarget==="source"?(i.sourceX+=e,i.sourceY+=n):(i.targetX+=e,i.targetY+=n),{...o}})}}const vn=(t,e,n,r)=>{const o=t+n,i=e+r/2;return[o,i,0]},yn=(t,e,n,r)=>{const o=t,i=e+r/2;return[o,i,180]},wn=(t,e,n,r)=>[t+n/2,e,90],bn=(t,e,n,r)=>{const o=t+n/2,i=e+r;return[o,i,270]};function Ue(t,e,n){const r=o;return r.type="dynamic",r;function o(){const i=ae(t,{edgeId:e});if(i.length!==2)throw`there should be two anchors per edge, have: ${i.length}`;let[s,l]=i;s.id!==n&&([s,l]=[l,s]);const a=ge(t,s.nodeId),c=ge(t,l.nodeId),[u,f,g,m]=[a.positionX+a.width/2,a.positionY+a.height/2,c.positionX+c.width/2,c.positionY+c.height/2];let _=s.angle;const x=(f-m)/(u-g);if(Math.abs(x)<1)if(a.positionX<c.positionX){const[w,b]=vn(a.positionX,a.positionY,a.width,a.height);yn(c.positionX,c.positionY,c.width,c.height),s.setPosition(w,b),s.angle=0}else{const[w,b]=yn(a.positionX,a.positionY,a.width,a.height);vn(c.positionX,c.positionY,c.width,c.height),s.setPosition(w,b),s.angle=180}else if(a.positionY<c.positionY){const[w,b]=bn(a.positionX,a.positionY,a.width,a.height);wn(c.positionX,c.positionY,c.width,c.height),s.setPosition(w,b),s.angle=270}else{const[w,b]=wn(a.positionX,a.positionY,a.width,a.height);bn(c.positionX,c.positionY,c.width,c.height),s.setPosition(w,b),s.angle=90}_!==s.angle&&l.callback()}}function Zl(t,e,n,r){return o;function o(){const i=he(t,e),s=ge(t,n),{positionX:l,positionY:a,width:c,height:u}=s,[f,g,m]=r(l,a,c,u);i.positionX=f,i.positionY=g,i.angle=m}}let Jl=class{constructor(e,n,r,o,i,s,l){this.id=e,this.nodeId=n,this.callback=r,this.positionX=o,this.positionY=i,this.angle=s,this.canvasId=l}delete(){const{potentialAnchorsStore:e}=It[this.canvasId];e.update(n=>{for(const r in n)n[r].id===this.id&&delete n[r];return{...n}})}};const $l=()=>(Math.random()+1).toString(36).substring(7);function Te(t,e,n,r){const o=$l(),i=Zl(e,o,n,t);return new Jl(o,n,i,-1,-1,0,r)}const an=()=>(Math.random()+1).toString(36).substring(7);function tc(t,e,n,r){const o=an(),i=new po(o,-1,-1,-1,-1,r,"","bezier","black","black","black",!1,!0,!1,()=>{},""),s=an(),l=Ue(t,o,s),a=new je(s,e,o,"source",-1,-1,l,r,0),c=an(),u=Ue(t,o,c),f=new je(c,n,o,"target",-1,-1,u,r,0),{edgesStore:g,anchorsStore:m}=t;m.update(x=>(x[s]=a,x[c]=f,{...x})),g.update(x=>(x[o]=i,{...x}));const _=ae(t);for(const x of _)x.callback()}const Pe=()=>(Math.random()+1).toString(36).substring(7);function ec(t,e,n,r,o){const i=Pe(),s=new En(i,n,r,100,100,"white",{label:"new node"},o,"black",!1,"","black",0,[],"",()=>{}),l=Te(vn,t,i,o),a=Te(yn,t,i,o),c=Te(wn,t,i,o),u=Te(bn,t,i,o),f=Pe(),g=new po(f,-1,-1,-1,-1,o,"","bezier","black","black","black",!1,!0,!1,()=>{},""),m=Pe(),_=Ue(t,f,m),x=new je(m,e,f,"source",-1,-1,_,o,0),w=Pe(),b=Ue(t,f,w),S=new je(w,i,f,"target",-1,-1,b,o,0),{nodesStore:A,edgesStore:N,anchorsStore:d,potentialAnchorsStore:h}=t;A.update(k=>(k[i]=s,{...k})),d.update(k=>(k[m]=x,k[w]=S,{...k})),h.update(k=>(k[l.id]=l,k[c.id]=c,k[u.id]=u,k[a.id]=a,{...k})),N.update(k=>(k[f]=g,{...k}));const E=ae(t);for(const k of E)k.callback();const I=Yr(t);for(const k of I)k.callback()}let nc=class{constructor(e,n,r,o,i,s,l,a,c,u){this.id=e,this.sourcePotentialAnchorId=n,this.sourceX=r,this.sourceY=o,this.targetPotentialAnchorId=i,this.targetX=s,this.targetY=l,this.canvasId=a,this.type=c,this.edgeColor=u}createEdge(){if(this.targetPotentialAnchorId===null)throw"cannot create edge with null target";const e=At(this.canvasId),n=he(e,this.sourcePotentialAnchorId),r=he(e,this.targetPotentialAnchorId),o=ge(e,n.nodeId),i=ge(e,r.nodeId);tc(e,o.id,i.id,this.canvasId)}createNode(){if(this.targetPotentialAnchorId!==null)throw"you should only create a node when you are hovering over blank space";const e=At(this.canvasId),r=he(e,this.sourcePotentialAnchorId).nodeId;ec(e,r,this.targetX,this.targetY,this.canvasId)}};function rc(t){let e,n,r,o;return{c(){e=at("div"),this.h()},l(i){e=lt(i,"DIV",{class:!0,style:!0}),V(e).forEach(M),this.h()},h(){p(e,"class","Anchor svelte-1amf2u8"),p(e,"style",n=`
      height:${Ce}px;
      width:${Ae}px;
      top: ${t[2]-Ce/2}px;
      left:${t[1]-Ae/2}px;
    `)},m(i,s){U(i,e,s),r||(o=[et(window,"mousemove",t[12]),et(window,"mouseup",t[13]),et(e,"mouseenter",t[14]),et(e,"mouseleave",t[15]),et(e,"mousedown",t[16])],r=!0)},p(i,[s]){s&6&&n!==(n=`
      height:${Ce}px;
      width:${Ae}px;
      top: ${i[2]-Ce/2}px;
      left:${i[1]-Ae/2}px;
    `)&&p(e,"style",n)},i:ct,o:ct,d(i){i&&M(e),r=!1,se(o)}}}let Ae=8,Ce=8;function oc(t,e,n){let r,o,{canvasId:i}=e,{x:s}=e,{y:l}=e,{potentialAnchorId:a}=e;const c=At(i),u=he(c,a),{temporaryEdgeStore:f}=At(i);let g=!1,m=!1;const _=()=>(Math.random()+1).toString(36).substring(7),x=N=>{N.preventDefault(),g&&f.update(d=>{if(d.length!==1)throw"if you are dragging, there should be one edge. We have not implemented multiple edges";const h=d[0],E=st(c.d3Scale);return h.targetX+=N.movementX/E,h.targetY+=N.movementY/E,[h]})},w=N=>{n(4,g=!1),st(f).length===1&&st(f)[0].targetPotentialAnchorId===a?f.update(d=>{for(let h of d)a===h.targetPotentialAnchorId&&h.createEdge();return[]}):st(f).length===1&&st(f)[0].targetPotentialAnchorId===null&&f.update(d=>{for(let h of d)h.createNode();return[]})},b=N=>{n(5,m=!0),f.update(d=>{for(let h of d)h.targetPotentialAnchorId=a;return[...d]})},S=N=>{n(5,m=!1),g&&f.update(d=>{for(let h of d)h.targetPotentialAnchorId===a&&(h.targetPotentialAnchorId=null);return[...d]})},A=N=>{N.preventDefault(),N.stopPropagation(),n(4,g=!0),f.update(d=>{if(d.length===0)return[new nc(_(),u.id,r,o,null,r,o,i,"straight","black")];throw"there should only be zero or one temporary edge at any given time"})};return t.$$set=N=>{"canvasId"in N&&n(0,i=N.canvasId),"x"in N&&n(1,s=N.x),"y"in N&&n(2,l=N.y),"potentialAnchorId"in N&&n(3,a=N.potentialAnchorId)},t.$$.update=()=>{t.$$.dirty&2&&n(7,r=s),t.$$.dirty&4&&n(6,o=l)},[i,s,l,a,g,m,o,r,c,u,f,_,x,w,b,S,A]}class ic extends dt{constructor(e){super(),gt(this,e,oc,rc,pt,{canvasId:0,x:1,y:2,potentialAnchorId:3})}}function sc(t){let e;return{c(){e=Q("path"),this.h()},l(n){e=Z(n,"path",{class:!0,d:!0,fill:!0,stroke:!0,"marker-end":!0,"aria-label":!0}),V(e).forEach(M),this.h()},h(){p(e,"class","animate svelte-qtkn5z"),p(e,"d",t[0]),p(e,"fill","transparent"),p(e,"stroke","gray"),p(e,"marker-end","url(#arrow)"),p(e,"aria-label","svg-path")},m(n,r){U(n,e,r)},p(n,[r]){r&1&&p(e,"d",n[0])},i:ct,o:ct,d(n){n&&M(e)}}}function ac(t,e,n){let{temporaryEdge:r}=e,o="";return t.$$set=i=>{"temporaryEdge"in i&&n(1,r=i.temporaryEdge)},t.$$.update=()=>{t.$$.dirty&2&&n(0,o=`M ${r.sourceX},${r.sourceY}L ${r.targetX},${r.targetY}`)},[o,r]}class lc extends dt{constructor(e){super(),gt(this,e,ac,sc,pt,{temporaryEdge:1})}}function cc(t){let e,n;return{c(){e=at("div"),this.h()},l(r){e=lt(r,"DIV",{class:!0,style:!0}),V(e).forEach(M),this.h()},h(){p(e,"class",n="nodes nodes-"+t[0]+" svelte-1eef8gz"),J(e,"top",t[1]+"px"),J(e,"left",t[2]+"px"),J(e,"height",t[4]+"px"),J(e,"width",t[3]+"px")},m(r,o){U(r,e,o)},p(r,[o]){o&1&&n!==(n="nodes nodes-"+r[0]+" svelte-1eef8gz")&&p(e,"class",n),o&2&&J(e,"top",r[1]+"px"),o&4&&J(e,"left",r[2]+"px"),o&16&&J(e,"height",r[4]+"px"),o&8&&J(e,"width",r[3]+"px")},i:ct,o:ct,d(r){r&&M(e)}}}function uc(t,e,n){let{key:r}=e,{node:o}=e,{heightRatio:i}=e,{widthRatio:s}=e,{nodeXleftPosition:l}=e,{nodeYbottomPosition:a}=e,c=0,u=0,f=0,g=0;return t.$$set=m=>{"key"in m&&n(0,r=m.key),"node"in m&&n(5,o=m.node),"heightRatio"in m&&n(6,i=m.heightRatio),"widthRatio"in m&&n(7,s=m.widthRatio),"nodeXleftPosition"in m&&n(8,l=m.nodeXleftPosition),"nodeYbottomPosition"in m&&n(9,a=m.nodeYbottomPosition)},t.$$.update=()=>{t.$$.dirty&992&&(n(4,g=Math.max(54*i,5)),n(3,f=Math.max(54*s,5)),n(1,c=o.positionY*i-a*i+1),n(2,u=o.positionX*s-l*s+1))},[r,c,u,f,g,o,i,s,l,a]}class fc extends dt{constructor(e){super(),gt(this,e,uc,cc,pt,{key:0,node:5,heightRatio:6,widthRatio:7,nodeXleftPosition:8,nodeYbottomPosition:9})}}function pr(t,e,n){const r=t.slice();return r[31]=e[n],r}function mr(t){let e,n;return e=new fc({props:{node:t[31],key:t[0],heightRatio:t[4],widthRatio:t[5],nodeXleftPosition:t[6],nodeYbottomPosition:t[7]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&256&&(i.node=r[31]),o[0]&1&&(i.key=r[0]),o[0]&16&&(i.heightRatio=r[4]),o[0]&32&&(i.widthRatio=r[5]),o[0]&64&&(i.nodeXleftPosition=r[6]),o[0]&128&&(i.nodeYbottomPosition=r[7]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function hc(t){let e,n,r,o,i,s,l,a,c=Object.values(t[8]),u=[];for(let g=0;g<c.length;g+=1)u[g]=mr(pr(t,c,g));const f=g=>K(u[g],1,1,()=>{u[g]=null});return{c(){e=at("div"),n=at("div"),o=xt();for(let g=0;g<u.length;g+=1)u[g].c();this.h()},l(g){e=lt(g,"DIV",{class:!0,style:!0});var m=V(e);n=lt(m,"DIV",{class:!0,style:!0}),V(n).forEach(M),o=St(m);for(let _=0;_<u.length;_+=1)u[_].l(m);m.forEach(M),this.h()},h(){p(n,"class",r="viewBox viewBox-"+t[0]+" svelte-ed1h8c"),J(n,"height",t[9]+"px"),J(n,"width",t[10]+"px"),J(n,"top",t[12]+"px"),J(n,"left",t[11]+"px"),p(e,"class",i=Nt(`miniMap miniMap-${t[0]}`)+" svelte-ed1h8c"),J(e,"height",t[3]+20+"px"),J(e,"width",t[2]+20+"px"),vt(e,"top-left",t[1]==="top-left"),vt(e,"top-right",t[1]==="top-right"),vt(e,"bottom-left",t[1]==="bottom-left"),vt(e,"bottom-right",t[1]==="bottom-right")},m(g,m){U(g,e,m),G(e,n),G(e,o);for(let _=0;_<u.length;_+=1)u[_].m(e,null);t[26](e),s=!0,l||(a=[et(e,"click",t[17]),et(e,"keydown",dc)],l=!0)},p(g,m){if((!s||m[0]&1&&r!==(r="viewBox viewBox-"+g[0]+" svelte-ed1h8c"))&&p(n,"class",r),(!s||m[0]&512)&&J(n,"height",g[9]+"px"),(!s||m[0]&1024)&&J(n,"width",g[10]+"px"),(!s||m[0]&4096)&&J(n,"top",g[12]+"px"),(!s||m[0]&2048)&&J(n,"left",g[11]+"px"),m[0]&497){c=Object.values(g[8]);let _;for(_=0;_<c.length;_+=1){const x=pr(g,c,_);u[_]?(u[_].p(x,m),q(u[_],1)):(u[_]=mr(x),u[_].c(),q(u[_],1),u[_].m(e,null))}for(Lt(),_=c.length;_<u.length;_+=1)f(_);Rt()}(!s||m[0]&1&&i!==(i=Nt(`miniMap miniMap-${g[0]}`)+" svelte-ed1h8c"))&&p(e,"class",i),(!s||m[0]&8)&&J(e,"height",g[3]+20+"px"),(!s||m[0]&4)&&J(e,"width",g[2]+20+"px"),(!s||m[0]&3)&&vt(e,"top-left",g[1]==="top-left"),(!s||m[0]&3)&&vt(e,"top-right",g[1]==="top-right"),(!s||m[0]&3)&&vt(e,"bottom-left",g[1]==="bottom-left"),(!s||m[0]&3)&&vt(e,"bottom-right",g[1]==="bottom-right")},i(g){if(!s){for(let m=0;m<c.length;m+=1)q(u[m]);s=!0}},o(g){u=u.filter(Boolean);for(let m=0;m<u.length;m+=1)K(u[m]);s=!1},d(g){g&&M(e),Ht(u,g),t[26](null),l=!1,se(a)}}}let Me=100;const dc=()=>{};function gc(t,e,n){let r,o,i,{key:s}=e,{d3Translate:l}=e,{store:a}=e,{location:c}=e;const{nodesStore:u,widthStore:f,heightStore:g}=a;it(t,u,O=>n(8,i=O)),it(t,f,O=>n(25,o=O)),it(t,g,O=>n(24,r=O));const m=Pr();let _=Me,x=Me,w=Me-10,b=Me-10,S=10,A=10,N=10,d=10,h=1,E=1,I=1/0,k=-1/0,z=1/0,j=-1/0,Y,nt=!1;const y=O=>O*(_/b),C=O=>O*(x/w);function T(O){if(!nt){let B=Y.getBoundingClientRect();nt=!0,m("message",{x:I+(O.clientX-B.left)/E,y:z+(O.clientY-B.top)/h}),setTimeout(()=>{nt=!1},500)}}function L(O){de[O?"unshift":"push"](()=>{Y=O,n(13,Y)})}return t.$$set=O=>{"key"in O&&n(0,s=O.key),"d3Translate"in O&&n(18,l=O.d3Translate),"store"in O&&n(19,a=O.store),"location"in O&&n(1,c=O.location)},t.$$.update=()=>{t.$$.dirty[0]&66322940&&(n(6,I=1/0),n(22,k=-1/0),n(7,z=1/0),n(23,j=-1/0),Object.values(i).forEach(O=>{n(6,I=Math.min(I,O.positionX)),n(23,j=Math.max(j,O.positionX)),n(7,z=Math.min(z,O.positionY)),n(22,k=Math.max(k,O.positionY))}),n(20,w=k-z),n(21,b=j-I),w>b?(n(3,x=100),n(2,_=Math.max(b.toFixed(0)*100/w.toFixed(0),25))):w<b?(n(2,_=100),n(3,x=Math.max(w.toFixed(0)*100/b.toFixed(0),25))):(n(3,x=100),n(2,_=100)),n(4,h=(x/w).toFixed(2)),n(5,E=(_/b).toFixed(2)),n(11,N=y(l.x*E-l.x/l.k)-I*E),n(12,d=C(l.y*h-l.y/l.k)-z*h),n(10,A=o*E/l.k),n(9,S=r*h/l.k))},[s,c,_,x,h,E,I,z,i,S,A,N,d,Y,u,f,g,T,l,a,w,b,k,j,r,o,L]}class pc extends dt{constructor(e){super(),gt(this,e,gc,hc,pt,{key:0,d3Translate:18,store:19,location:1},null,[-1,-1])}}function _r(t,e,n){const r=t.slice();return r[40]=e[n],r}function vr(t,e,n){const r=t.slice();return r[43]=e[n],r}function yr(t,e,n){const r=t.slice();return r[46]=e[n],r}function wr(t,e,n){const r=t.slice();return r[49]=e[n],r}function br(t,e,n){const r=t.slice();return r[52]=e[n],r}function kr(t){let e,n,r;return n=new pc({props:{key:t[13],d3Translate:t[2],store:t[12],location:t[1]}}),n.$on("message",t[24]),{c(){e=at("div"),ut(n.$$.fragment),this.h()},l(o){e=lt(o,"DIV",{class:!0});var i=V(e);mt(n.$$.fragment,i),i.forEach(M),this.h()},h(){p(e,"class","pointer-events-auto svelte-c90zt3")},m(o,i){U(o,e,i),ft(n,e,null),r=!0},p(o,i){const s={};i[0]&4&&(s.d3Translate=o[2]),i[0]&2&&(s.location=o[1]),n.$set(s)},i(o){r||(q(n.$$.fragment,o),r=!0)},o(o){K(n.$$.fragment,o),r=!1},d(o){o&&M(e),ht(n)}}}function Er(t){let e,n;return e=new Ql({props:{node:t[52],canvasId:t[0],nodeId:t[52].id}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&128&&(i.node=r[52]),o[0]&1&&(i.canvasId=r[0]),o[0]&128&&(i.nodeId=r[52].id),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function xr(t){let e,n;return e=new ic({props:{canvasId:t[0],x:t[49].positionX,y:t[49].positionY,potentialAnchorId:t[49].id}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&1&&(i.canvasId=r[0]),o[0]&16&&(i.x=r[49].positionX),o[0]&16&&(i.y=r[49].positionY),o[0]&16&&(i.potentialAnchorId=r[49].id),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Sr(t){let e,n;return{c(){e=Q("rect"),n=Q("rect"),this.h()},l(r){e=Z(r,"rect",{width:!0,height:!0,style:!0}),V(e).forEach(M),n=Z(r,"rect",{width:!0,height:!0,style:!0}),V(n).forEach(M),this.h()},h(){p(e,"width","100%"),p(e,"height","100%"),J(e,"fill","url(#background-"+t[0]+")"),p(n,"width","100%"),p(n,"height","100%"),J(n,"fill","url(#coarse-background-"+t[0]+")")},m(r,o){U(r,e,o),U(r,n,o)},p(r,o){o[0]&1&&J(e,"fill","url(#background-"+r[0]+")"),o[0]&1&&J(n,"fill","url(#coarse-background-"+r[0]+")")},d(r){r&&M(e),r&&M(n)}}}function mc(t){let e,n;return e=new zl({props:{edgeId:t[46].id,canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&64&&(i.edgeId=r[46].id),o[0]&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function _c(t){let e,n;return e=new Fl({props:{edge:t[46],canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&64&&(i.edge=r[46]),o[0]&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function vc(t){let e,n;return e=new go({props:{edge:t[46],canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&64&&(i.edge=r[46]),o[0]&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function yc(t){let e,n;return e=new ql({props:{edgeId:t[46].id,canvasId:t[0]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&64&&(i.edgeId=r[46].id),o[0]&1&&(i.canvasId=r[0]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Ir(t){let e,n,r,o;const i=[yc,vc,_c,mc],s=[];function l(a,c){return a[46].type==="straight"?0:a[46].type==="smoothstep"?1:a[46].type==="step"?2:3}return e=l(t),n=s[e]=i[e](t),{c(){n.c(),r=Tt()},l(a){n.l(a),r=Tt()},m(a,c){s[e].m(a,c),U(a,r,c),o=!0},p(a,c){let u=e;e=l(a),e===u?s[e].p(a,c):(Lt(),K(s[u],1,1,()=>{s[u]=null}),Rt(),n=s[e],n?n.p(a,c):(n=s[e]=i[e](a),n.c()),q(n,1),n.m(r.parentNode,r))},i(a){o||(q(n),o=!0)},o(a){K(n),o=!1},d(a){s[e].d(a),a&&M(r)}}}function Nr(t){let e,n;return e=new lc({props:{temporaryEdge:t[43]}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&8&&(i.temporaryEdge=r[43]),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function Tr(t){let e,n;return e=new Ul({props:{x:t[40].positionX,y:t[40].positionY}}),{c(){ut(e.$$.fragment)},l(r){mt(e.$$.fragment,r)},m(r,o){ft(e,r,o),n=!0},p(r,o){const i={};o[0]&32&&(i.x=r[40].positionX),o[0]&32&&(i.y=r[40].positionY),e.$set(i)},i(r){n||(q(e.$$.fragment,r),n=!0)},o(r){K(e.$$.fragment,r),n=!1},d(r){ht(e,r)}}}function wc(t){let e,n,r,o,i,s,l,a,c,u,f,g,m,_,x,w,b,S,A,N,d,h,E,I,k,z=t[1]!=="none"&&kr(t),j=t[7],Y=[];for(let v=0;v<j.length;v+=1)Y[v]=Er(br(t,j,v));const nt=v=>K(Y[v],1,1,()=>{Y[v]=null});let y=t[4],C=[];for(let v=0;v<y.length;v+=1)C[v]=xr(wr(t,y,v));const T=v=>K(C[v],1,1,()=>{C[v]=null});let L=t[11]&&Sr(t),O=t[6],B=[];for(let v=0;v<O.length;v+=1)B[v]=Ir(yr(t,O,v));const X=v=>K(B[v],1,1,()=>{B[v]=null});let F=t[3],D=[];for(let v=0;v<F.length;v+=1)D[v]=Nr(vr(t,F,v));const tt=v=>K(D[v],1,1,()=>{D[v]=null});let W=t[5],H=[];for(let v=0;v<W.length;v+=1)H[v]=Tr(_r(t,W,v));const Et=v=>K(H[v],1,1,()=>{H[v]=null});return{c(){e=at("div"),z&&z.c(),n=xt(),r=at("div"),o=at("div");for(let v=0;v<Y.length;v+=1)Y[v].c();i=xt();for(let v=0;v<C.length;v+=1)C[v].c();a=xt(),c=Q("svg"),u=Q("defs"),f=Q("pattern"),g=Q("circle"),_=Q("pattern"),x=Q("circle"),L&&L.c(),S=Q("g");for(let v=0;v<B.length;v+=1)B[v].c();A=Tt();for(let v=0;v<D.length;v+=1)D[v].c();N=Tt();for(let v=0;v<H.length;v+=1)H[v].c();this.h()},l(v){e=lt(v,"DIV",{id:!0,class:!0});var R=V(e);z&&z.l(R),n=St(R),r=lt(R,"DIV",{class:!0});var P=V(r);o=lt(P,"DIV",{class:!0});var rt=V(o);for(let ot=0;ot<Y.length;ot+=1)Y[ot].l(rt);i=St(rt);for(let ot=0;ot<C.length;ot+=1)C[ot].l(rt);rt.forEach(M),P.forEach(M),R.forEach(M),a=St(v),c=Z(v,"svg",{class:!0,viewBox:!0});var be=V(c);u=Z(be,"defs",{});var en=V(u);f=Z(en,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,class:!0});var On=V(f);g=Z(On,"circle",{id:!0,cx:!0,cy:!0,r:!0,style:!0}),V(g).forEach(M),On.forEach(M),_=Z(en,"pattern",{id:!0,x:!0,y:!0,width:!0,height:!0,patternUnits:!0,class:!0});var Ln=V(_);x=Z(Ln,"circle",{id:!0,cx:!0,cy:!0,r:!0,style:!0}),V(x).forEach(M),Ln.forEach(M),en.forEach(M),L&&L.l(be),S=Z(be,"g",{});var ke=V(S);for(let ot=0;ot<B.length;ot+=1)B[ot].l(ke);A=Tt();for(let ot=0;ot<D.length;ot+=1)D[ot].l(ke);N=Tt();for(let ot=0;ot<H.length;ot+=1)H[ot].l(ke);ke.forEach(M),be.forEach(M),this.h()},h(){p(o,"class",s=Nt(`Node Node-${t[0]}`)+" svelte-c90zt3"),p(r,"class",l=Nt(`Nodes Nodes-${t[0]}`)+" svelte-c90zt3"),p(e,"id","graphview-container"),p(e,"class","svelte-c90zt3"),p(g,"id","dot"),p(g,"cx",wt/2-Gt/2),p(g,"cy",wt/2-Gt/2),p(g,"r","0.5"),J(g,"fill","gray"),p(f,"id",m=`background-${t[0]}`),p(f,"x","0"),p(f,"y","0"),p(f,"width",wt),p(f,"height",wt),p(f,"patternUnits","userSpaceOnUse"),p(f,"class","svelte-c90zt3"),p(x,"id","coarse-dot"),p(x,"cx",wt/2-Gt/2),p(x,"cy",wt/2-Gt/2),p(x,"r","0.75"),p(x,"style",w=t[10]==="light"?"fill: #222222":"fill: white"),p(_,"id",b=`coarse-background-${t[0]}`),p(_,"x","0"),p(_,"y","0"),p(_,"width",te*wt),p(_,"height",te*wt),p(_,"patternUnits","userSpaceOnUse"),p(_,"class","svelte-c90zt3"),p(c,"class",d=Nt(`Edges Edges-${t[0]}`)+" svelte-c90zt3"),p(c,"viewBox",h="0 0 "+t[8]+" "+t[9])},m(v,R){U(v,e,R),z&&z.m(e,null),G(e,n),G(e,r),G(r,o);for(let P=0;P<Y.length;P+=1)Y[P].m(o,null);G(o,i);for(let P=0;P<C.length;P+=1)C[P].m(o,null);U(v,a,R),U(v,c,R),G(c,u),G(u,f),G(f,g),G(u,_),G(_,x),L&&L.m(c,null),G(c,S);for(let P=0;P<B.length;P+=1)B[P].m(S,null);G(S,A);for(let P=0;P<D.length;P+=1)D[P].m(S,null);G(S,N);for(let P=0;P<H.length;P+=1)H[P].m(S,null);E=!0,I||(k=[et(r,"contextmenu",zn(t[33])),et(c,"contextmenu",zn(t[32]))],I=!0)},p(v,R){if(v[1]!=="none"?z?(z.p(v,R),R[0]&2&&q(z,1)):(z=kr(v),z.c(),q(z,1),z.m(e,n)):z&&(Lt(),K(z,1,1,()=>{z=null}),Rt()),R[0]&129){j=v[7];let P;for(P=0;P<j.length;P+=1){const rt=br(v,j,P);Y[P]?(Y[P].p(rt,R),q(Y[P],1)):(Y[P]=Er(rt),Y[P].c(),q(Y[P],1),Y[P].m(o,i))}for(Lt(),P=j.length;P<Y.length;P+=1)nt(P);Rt()}if(R[0]&17){y=v[4];let P;for(P=0;P<y.length;P+=1){const rt=wr(v,y,P);C[P]?(C[P].p(rt,R),q(C[P],1)):(C[P]=xr(rt),C[P].c(),q(C[P],1),C[P].m(o,null))}for(Lt(),P=y.length;P<C.length;P+=1)T(P);Rt()}if((!E||R[0]&1&&s!==(s=Nt(`Node Node-${v[0]}`)+" svelte-c90zt3"))&&p(o,"class",s),(!E||R[0]&1&&l!==(l=Nt(`Nodes Nodes-${v[0]}`)+" svelte-c90zt3"))&&p(r,"class",l),(!E||R[0]&1&&m!==(m=`background-${v[0]}`))&&p(f,"id",m),(!E||R[0]&1024&&w!==(w=v[10]==="light"?"fill: #222222":"fill: white"))&&p(x,"style",w),(!E||R[0]&1&&b!==(b=`coarse-background-${v[0]}`))&&p(_,"id",b),v[11]?L?L.p(v,R):(L=Sr(v),L.c(),L.m(c,S)):L&&(L.d(1),L=null),R[0]&65){O=v[6];let P;for(P=0;P<O.length;P+=1){const rt=yr(v,O,P);B[P]?(B[P].p(rt,R),q(B[P],1)):(B[P]=Ir(rt),B[P].c(),q(B[P],1),B[P].m(S,A))}for(Lt(),P=O.length;P<B.length;P+=1)X(P);Rt()}if(R[0]&8){F=v[3];let P;for(P=0;P<F.length;P+=1){const rt=vr(v,F,P);D[P]?(D[P].p(rt,R),q(D[P],1)):(D[P]=Nr(rt),D[P].c(),q(D[P],1),D[P].m(S,N))}for(Lt(),P=F.length;P<D.length;P+=1)tt(P);Rt()}if(R[0]&32){W=v[5];let P;for(P=0;P<W.length;P+=1){const rt=_r(v,W,P);H[P]?(H[P].p(rt,R),q(H[P],1)):(H[P]=Tr(rt),H[P].c(),q(H[P],1),H[P].m(S,null))}for(Lt(),P=W.length;P<H.length;P+=1)Et(P);Rt()}(!E||R[0]&1&&d!==(d=Nt(`Edges Edges-${v[0]}`)+" svelte-c90zt3"))&&p(c,"class",d),(!E||R[0]&768&&h!==(h="0 0 "+v[8]+" "+v[9]))&&p(c,"viewBox",h)},i(v){if(!E){q(z);for(let R=0;R<j.length;R+=1)q(Y[R]);for(let R=0;R<y.length;R+=1)q(C[R]);for(let R=0;R<O.length;R+=1)q(B[R]);for(let R=0;R<F.length;R+=1)q(D[R]);for(let R=0;R<W.length;R+=1)q(H[R]);E=!0}},o(v){K(z),Y=Y.filter(Boolean);for(let R=0;R<Y.length;R+=1)K(Y[R]);C=C.filter(Boolean);for(let R=0;R<C.length;R+=1)K(C[R]);B=B.filter(Boolean);for(let R=0;R<B.length;R+=1)K(B[R]);D=D.filter(Boolean);for(let R=0;R<D.length;R+=1)K(D[R]);H=H.filter(Boolean);for(let R=0;R<H.length;R+=1)K(H[R]);E=!1},d(v){v&&M(e),z&&z.d(),Ht(Y,v),Ht(C,v),v&&M(a),v&&M(c),L&&L.d(),Ht(B,v),Ht(D,v),Ht(H,v),I=!1,se(k)}}}const wt=15,Gt=10,te=3;function bc(t,e,n){let r,o,i,s,l,a,c,u,f,g,m,_,x,w,b,{canvasId:S}=e,{initialZoom:A=3}=e,{initialLocation:N}=e,{minimap:d="none"}=e;const h=At(S),E=S,{edgesStore:I,nodesStore:k,anchorsStore:z,potentialAnchorsStore:j,temporaryEdgeStore:Y,nodeSelected:nt,backgroundStore:y,movementStore:C,widthStore:T,heightStore:L,d3Scale:O,themeStore:B}=h;it(t,I,v=>n(30,g=v)),it(t,k,v=>n(31,m=v)),it(t,z,v=>n(29,f=v)),it(t,j,v=>n(28,u=v)),it(t,Y,v=>n(27,c=v)),it(t,y,v=>n(11,b=v)),it(t,C,v=>n(34,a=v)),it(t,T,v=>n(8,_=v)),it(t,L,v=>n(9,x=v)),it(t,B,v=>n(10,w=v));let X={x:0,y:0,k:1},F={zoom:kl,zoomTransform:ho,zoomIdentity:tn,select:qt,selectAll:As,pointer:Ft},D=xl(F,nt,W);function tt(v){F.select(`.Edges-${E}`).transition().duration(500).call(D.translateTo,v.detail.x,v.detail.y),F.select(`.Nodes-${E}`).transition().duration(500).call(D.translateTo,v.detail.x,v.detail.y)}function W(v){if(!a)return;O.set(v.transform.k),y&&(F.select(`#background-${S}`).attr("x",v.transform.x).attr("y",v.transform.y).attr("width",wt*v.transform.k).attr("height",wt*v.transform.k).selectAll("#dot").attr("x",wt*v.transform.k/2-Gt/2).attr("y",wt*v.transform.k/2-Gt/2).attr("opacity",Math.min(v.transform.k-.5,1)),F.select(`#coarse-background-${S}`).attr("x",v.transform.x).attr("y",v.transform.y).attr("width",te*wt*v.transform.k).attr("height",te*wt*v.transform.k).selectAll("#coarse-dot").attr("x",te*(wt*v.transform.k/2-Gt/2)).attr("y",te*(wt*v.transform.k/2-Gt/2)).attr("opacity",Math.min(v.transform.k-.2,1))),F.select(`.Edges-${S} g`).attr("transform",v.transform);let R=F.zoomTransform(this);n(2,X=R),F.select(`.Node-${S}`).style("transform","translate("+R.x+"px,"+R.y+"px) scale("+R.k+")").style("transform-origin","0 0")}Ar(()=>{F.select(`.Edges-${S}`).call(D),F.select(`.Nodes-${S}`).call(D),F.select(`#background-${S}`).call(D),F.selectAll("#dot").call(D),n(2,X=El(F,S,D,X,N,A,O))});function H(v){ln.call(this,t,v)}function Et(v){ln.call(this,t,v)}return t.$$set=v=>{"canvasId"in v&&n(0,S=v.canvasId),"initialZoom"in v&&n(25,A=v.initialZoom),"initialLocation"in v&&n(26,N=v.initialLocation),"minimap"in v&&n(1,d=v.minimap)},t.$$.update=()=>{t.$$.dirty[1]&1&&n(7,r=Object.values(m)),t.$$.dirty[0]&1073741824&&n(6,o=Object.values(g)),t.$$.dirty[0]&536870912&&n(5,i=Object.values(f)),t.$$.dirty[0]&268435456&&n(4,s=Object.values(u)),t.$$.dirty[0]&134217728&&n(3,l=c)},[S,d,X,l,s,i,o,r,_,x,w,b,h,E,I,k,z,j,Y,y,C,T,L,B,tt,A,N,c,u,f,g,m,H,Et]}class kc extends dt{constructor(e){super(),gt(this,e,bc,wc,pt,{canvasId:0,initialZoom:25,initialLocation:26,minimap:1},null,[-1,-1])}}function Ec(t){let e,n,r,o,i;return r=new kc({props:{canvasId:t[3],initialLocation:t[5],initialZoom:t[4],minimap:t[1]}}),{c(){e=at("div"),n=at("div"),ut(r.$$.fragment),this.h()},l(s){e=lt(s,"DIV",{class:!0});var l=V(e);n=lt(l,"DIV",{class:!0,style:!0});var a=V(n);mt(r.$$.fragment,a),a.forEach(M),l.forEach(M),this.h()},h(){p(n,"class","svelvet svelte-1gzujgr"),p(n,"style",o=`width: ${t[7]}px; height: ${t[8]}px;`),p(e,"class","container svelte-1gzujgr"),vt(e,"svelvet-dark",t[0]==="dark"),vt(e,"translucent",t[2])},m(s,l){U(s,e,l),G(e,n),ft(r,n,null),t[17](e),i=!0},p(s,[l]){const a={};l&8&&(a.canvasId=s[3]),l&32&&(a.initialLocation=s[5]),l&16&&(a.initialZoom=s[4]),l&2&&(a.minimap=s[1]),r.$set(a),(!i||l&384&&o!==(o=`width: ${s[7]}px; height: ${s[8]}px;`))&&p(n,"style",o),(!i||l&1)&&vt(e,"svelvet-dark",s[0]==="dark"),(!i||l&4)&&vt(e,"translucent",s[2])},i(s){i||(q(r.$$.fragment,s),i=!0)},o(s){K(r.$$.fragment,s),i=!1},d(s){s&&M(e),ht(r),t[17](null)}}}function xc(t,e,n){const r=()=>(Math.random()+1).toString(36).substring(7);let{graph:o}=e,{loader:i=k=>null}=e,{theme:s="light"}=e,{minimap:l="none"}=e,{translucent:a=!1}=e,{background:c=!0}=e,{movement:u=!0}=e,{canvasId:f=r()}=e,{snap:g=!1}=e,{snapTo:m=15}=e,{nodeCreate:_=!1}=e,{initialZoom:x=3}=e,{initialLocation:w={x:0,y:0}}=e;const b=Pr(),S=Uo(f);let A,N,d=1,h=1;function E(k){return Wo(S,f,k)===!1?(b("error","invalid component!"),!1):!0}Ar(async()=>{S.widthStore.set(d),S.heightStore.set(h),S.backgroundStore.set(c),S.movementStore.set(u);const k={snap:g,snapTo:m};S.options.set(k),S.nodeCreate.set(_),S.loaderStore.set(i),S.graphStore.set(o),S.themeStore.set(s),S.graphStore.subscribe(z=>{n(9,o=z)}),N=new ResizeObserver(z=>{n(7,d=z[0].contentRect.width),n(8,h=z[0].contentRect.height)}),N.observe(A),await vo(),n(7,d=A.clientWidth),n(8,h=A.clientHeight)}),yo(()=>{N==null||N.unobserve(A)}),wo(()=>{S.widthStore.set(d),S.heightStore.set(h),S.backgroundStore.set(c),S.movementStore.set(u);const k={snap:g,snapTo:m};S.options.set(k),S.nodeCreate.set(_),S.themeStore.set(s)});function I(k){de[k?"unshift":"push"](()=>{A=k,n(6,A)})}return t.$$set=k=>{"graph"in k&&n(9,o=k.graph),"loader"in k&&n(10,i=k.loader),"theme"in k&&n(0,s=k.theme),"minimap"in k&&n(1,l=k.minimap),"translucent"in k&&n(2,a=k.translucent),"background"in k&&n(11,c=k.background),"movement"in k&&n(12,u=k.movement),"canvasId"in k&&n(3,f=k.canvasId),"snap"in k&&n(13,g=k.snap),"snapTo"in k&&n(14,m=k.snapTo),"nodeCreate"in k&&n(15,_=k.nodeCreate),"initialZoom"in k&&n(4,x=k.initialZoom),"initialLocation"in k&&n(5,w=k.initialLocation)},[s,l,a,f,x,w,A,d,h,o,i,c,u,g,m,_,E,I]}class Sc extends dt{constructor(e){super(),gt(this,e,xc,Ec,pt,{graph:9,loader:10,theme:0,minimap:1,translucent:2,background:11,movement:12,canvasId:3,snap:13,snapTo:14,nodeCreate:15,initialZoom:4,initialLocation:5,addNode:16})}get addNode(){return this.$$.ctx[16]}}const Ic={inPorts:["in"],outPorts:[],category:"core",icon:qo,factory:t=>{const e=new t({description:"Logs packets to browser console",inPorts:{in:{datatype:"object",required:!0}}});return e.process((n,r)=>{if(!n.hasData("in"))return;const o=n.getData("in");console.log(o),r.done()}),e}},Nc={inPorts:["input"],outPorts:["output"],category:"core",icon:Do,factory:t=>{const e=new t({description:"filters based on an input string",inPorts:{input:{datatype:"number",required:!0}},outPorts:{output:{datatype:"number"}}});return e.process((n,r)=>{if(!n.hasData("augend","addend"))return;const[o,i]=n.getData("augend","addend");r.sendDone({sum:Number(o)+Number(i)})}),e}},Tc={inPorts:["augend","addend","anotherInput","otherTest","HEY"],outPorts:["sum","notify"],category:"core",icon:zo,factory:t=>{const e=new t({description:"reshapes a data packet",inPorts:{augend:{datatype:"number",required:!0},addend:{datatype:"number",required:!0}},outPorts:{sum:{datatype:"number"}}});return e.process((n,r)=>{if(!n.hasData("augend","addend"))return;const[o,i]=n.getData("augend","addend");r.sendDone({sum:Number(o)+Number(i)})}),e}},Pc={"console log":Ic,filter:Nc,reshape:Tc};function Ac(t){let e,n,r,o,i,s,l,a,c,u,f,g,m,_,x,w,b,S;function A(h){t[5](h)}function N(h){t[6](h)}let d={loader:t[3],minimap:"top-right"};return t[2]!==void 0&&(d.graph=t[2]),t[1]!==void 0&&(d.theme=t[1]),r=new Sc({props:d}),t[4](r),de.push(()=>Bn(r,"graph",A)),de.push(()=>Bn(r,"theme",N)),{c(){e=xt(),n=at("div"),ut(r.$$.fragment),s=xt(),l=at("div"),a=at("button"),c=jt("Toggle Theme"),u=xt(),f=at("button"),g=jt("Log Graph"),m=xt(),_=at("button"),x=jt("Add Reshape"),this.h()},l(h){bo("svelte-tnuivb",document.head).forEach(M),e=St(h),n=lt(h,"DIV",{class:!0});var I=V(n);mt(r.$$.fragment,I),I.forEach(M),s=St(h),l=lt(h,"DIV",{class:!0});var k=V(l);a=lt(k,"BUTTON",{class:!0});var z=V(a);c=Ut(z,"Toggle Theme"),z.forEach(M),u=St(k),f=lt(k,"BUTTON",{class:!0});var j=V(f);g=Ut(j,"Log Graph"),j.forEach(M),m=St(k),_=lt(k,"BUTTON",{class:!0});var Y=V(_);x=Ut(Y,"Add Reshape"),Y.forEach(M),k.forEach(M),this.h()},h(){document.title="Noflo-Svelte",p(n,"class","editor svelte-dvct1s"),p(a,"class","svelte-dvct1s"),p(f,"class","svelte-dvct1s"),p(_,"class","svelte-dvct1s"),p(l,"class","overlay svelte-dvct1s")},m(h,E){U(h,e,E),U(h,n,E),ft(r,n,null),U(h,s,E),U(h,l,E),G(l,a),G(a,c),G(l,u),G(l,f),G(f,g),G(l,m),G(l,_),G(_,x),w=!0,b||(S=[et(a,"click",t[7]),et(f,"click",t[8]),et(_,"click",t[9])],b=!0)},p(h,[E]){const I={};!o&&E&4&&(o=!0,I.graph=h[2],Xn(()=>o=!1)),!i&&E&2&&(i=!0,I.theme=h[1],Xn(()=>i=!1)),r.$set(I)},i(h){w||(q(r.$$.fragment,h),w=!0)},o(h){K(r.$$.fragment,h),w=!1},d(h){h&&M(e),h&&M(n),t[4](null),ht(r),h&&M(s),h&&M(l),b=!1,se(S)}}}function Cc(t,e,n){let r,o="light",i={caseSensitive:!1,properties:{name:""},inports:{},outports:{},groups:[],processes:{q7:{component:"console log",metadata:{label:"console log",x:100,y:50}},"23wa":{component:"reshape",metadata:{label:"reshape",x:100,y:200,portSettings:[{name:"augend",mode:"constant",constant:"{}"},{name:"addend",mode:"constant",constant:`ts
		{et"}
	`}]}}},connections:[{src:{process:"q7",port:"out"},tgt:{process:"q7",port:"port"},metadata:{}},{src:{process:"q7",port:"out"},tgt:{process:"23wa",port:"augend"},metadata:{route:0}},{data:{},tgt:{process:"23wa",port:"augend"}},{data:{},tgt:{process:"23wa",port:"addend"}}]};function s(m){return Pc[m]}function l(m){de[m?"unshift":"push"](()=>{r=m,n(0,r)})}function a(m){i=m,n(2,i)}function c(m){o=m,n(1,o)}return[r,o,i,s,l,a,c,()=>{n(1,o=o==="light"?"dark":"light")},()=>{console.log(i)},()=>{r.addNode("reshape")}]}class Xc extends dt{constructor(e){super(),gt(this,e,Cc,Ac,pt,{})}}export{Xc as default};
